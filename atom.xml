<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>火柴的博客</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2016-08-23T09:04:04.408Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>CH</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>git命令用法</title>
    <link href="http://yoursite.com/2016/08/23/git%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/"/>
    <id>http://yoursite.com/2016/08/23/git命令用法/</id>
    <published>2016-08-23T06:02:34.000Z</published>
    <updated>2016-08-23T09:04:04.408Z</updated>
    
    <content type="html"><![CDATA[<p>&#x672C;&#x6587;&#x4EC5;&#x8BB0;&#x5F55;&#x81EA;&#x5DF1;&#x5728;&#x5B66;&#x4E60;git&#x547D;&#x4EE4;&#x8FC7;&#x7A0B;&#x7684;&#x4E00;&#x4E9B;&#x547D;&#x4EE4;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x4E9B;&#x8F83;&#x96BE;&#x8BB0;&#x5FC6;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x65B9;&#x4FBF;&#x540E;&#x671F;&#x5728;&#x4F7F;&#x7528;git&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x66F4;&#x597D;&#x7684;&#x67E5;&#x627E;&#x4F7F;&#x7528;&#x3002;<br>&#x66F4;&#x52A0;&#x8BE6;&#x7EC6;&#x7684;git&#x6559;&#x7A0B;&#x8BF7;&#x53C2;&#x8003;&#x5ED6;&#x96EA;&#x950B;&#x5B98;&#x7F51;&#x7684;<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="external">git&#x6559;&#x7A0B;</a><br>&#x8FD9;&#x91CC;&#x5C31;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x4E3B;&#x9898;&#xFF0C;git&#x7684;&#x5B89;&#x88C5;&#xFF0C;&#x672C;&#x6587;&#x5168;&#x662F;&#x5728;CentOS6.7&#x7684;&#x73AF;&#x5883;&#x4E2D;&#x5B8C;&#x6210;&#x7684;<br><a id="more"></a></p>
<p></p><h2 id="&#x5728;linux&#x4E0A;&#x5B89;&#x88C5;git">&#x5728;linux&#x4E0A;&#x5B89;&#x88C5;git</h2><br>&#x9996;&#x5148;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x7EC8;&#x7AEF;&#x754C;&#x9762;&#x8F93;&#x5165;git&#xFF0C;&#x770B;&#x770B;&#x7CFB;&#x7EDF;&#x6709;&#x6CA1;&#x6709;&#x5B89;&#x88C5;Git&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#xFF0C;&#x76F4;&#x63A5;&#x8FD0;&#x884C;&#x547D;&#x4EE4;&#x5B89;&#x88C5;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># yum -y install git</span></div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x521B;&#x5EFA;&#x7248;&#x672C;&#x5E93;">&#x521B;&#x5EFA;&#x7248;&#x672C;&#x5E93;</h2><br>&#x7248;&#x672C;&#x5E93;&#x53C8;&#x540D;&#x4ED3;&#x5E93;&#xFF0C;&#x82F1;&#x6587;&#x540D;repository&#xFF0C;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x7406;&#x89E3;&#x6210;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x91CC;&#x9762;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x90FD;&#x53EF;&#x4EE5;&#x88AB;Git&#x7BA1;&#x7406;&#x8D77;&#x6765;&#xFF0C;&#x6BCF;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x4FEE;&#x6539;&#x3001;&#x5220;&#x9664;&#xFF0C;Git&#x90FD;&#x80FD;&#x8DDF;&#x8E2A;&#xFF0C;&#x4EE5;&#x4FBF;&#x4EFB;&#x4F55;&#x65F6;&#x523B;&#x90FD;&#x53EF;&#x4EE5;&#x8FFD;&#x8E2A;&#x5386;&#x53F2;&#xFF0C;&#x6216;&#x8005;&#x5728;&#x5C06;&#x6765;&#x67D0;&#x4E2A;&#x65F6;&#x523B;&#x53EF;&#x4EE5;&#x201C;&#x8FD8;&#x539F;&#x201D;&#x3002;<p></p>
<ul>
<li><p>&#x6240;&#x4EE5;&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x5E93;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x9996;&#x5148;&#xFF0C;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x76EE;&#x5F55;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /home/<span class="built_in">test</span></div><div class="line"><span class="built_in">cd</span> /home/<span class="built_in">test</span></div></pre></td></tr></table></figure>
</li>
<li><p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF0C;&#x8FD0;&#x884C;git init&#x547D;&#x4EE4;&#x628A;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x53D8;&#x6210;Git&#x53EF;&#x4EE5;&#x7BA1;&#x7406;&#x7684;&#x4ED3;&#x5E93;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git init /home/<span class="built_in">test</span></div></pre></td></tr></table></figure>
</li>
<li><p>&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x6765;&#x53EF;&#x4EE5;&#x5728;/home/test/&#x76EE;&#x5F55;&#x4E0B;&#x7F16;&#x8F91;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E86;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">vim readme.txt</div><div class="line"><span class="built_in">test</span> 1</div></pre></td></tr></table></figure></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文仅记录自己在学习git命令过程的一些命令，以及一些较难记忆的地方，方便后期在使用git的过程中更好的查找使用。&lt;br&gt;更加详细的git教程请参考廖雪锋官网的&lt;a href=&quot;http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000&quot;&gt;git教程&lt;/a&gt;&lt;br&gt;这里就直接进入主题，git的安装，本文全是在CentOS6.7的环境中完成的&lt;br&gt;
    
    </summary>
    
      <category term="工具" scheme="http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>DNS解析原理</title>
    <link href="http://yoursite.com/2016/08/23/DNS%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"/>
    <id>http://yoursite.com/2016/08/23/DNS解析原理/</id>
    <published>2016-08-23T03:48:21.000Z</published>
    <updated>2016-08-23T04:04:33.419Z</updated>
    
    <content type="html"><![CDATA[<p>DNS( Domain Name System)&#x662F;&#x201C;&#x57DF;&#x540D;&#x7CFB;&#x7EDF;&#x201D;&#x7684;&#x82F1;&#x6587;&#x7F29;&#x5199;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x7EC4;&#x7EC7;&#x6210;&#x57DF;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x548C;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x547D;&#x540D;&#x7CFB;&#x7EDF;&#xFF0C;&#x5B83;&#x7528;&#x4E8E;TCP/IP&#x7F51;&#x7EDC;&#xFF0C;&#x5B83;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x670D;&#x52A1;&#x662F;&#x7528;&#x6765;&#x5C06;&#x4E3B;&#x673A;&#x540D;&#x548C;&#x57DF;&#x540D;&#x8F6C;&#x6362;&#x4E3A;IP&#x5730;&#x5740;&#x7684;&#x5DE5;&#x4F5C;&#x3002;&#x7B80;&#x5355;&#x70B9;&#x6765;&#x8BF4;&#xFF0C;DNS&#x5C31;&#x662F;&#x4E00;&#x4F4D;&#x201C;&#x7FFB;&#x8BD1;&#x5B98;&#x201D;&#x3002;<br><a id="more"></a></p>
<p></p><h3 id="&#x89E3;&#x6790;&#x539F;&#x7406;">&#x89E3;&#x6790;&#x539F;&#x7406;</h3><br>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x5BA2;&#x6237;&#x673A;&#x63D0;&#x51FA;&#x57DF;&#x540D;&#x89E3;&#x6790;&#x8BF7;&#x6C42;,&#x5E76;&#x5C06;&#x8BE5;&#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x7ED9;&#x672C;&#x5730;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x3002;<br>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x5F53;&#x672C;&#x5730;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x540E;,&#x5C31;&#x5148;&#x67E5;&#x8BE2;&#x672C;&#x5730;&#x7684;&#x7F13;&#x5B58;,&#x5982;&#x679C;&#x6709;&#x8BE5;&#x7EAA;&#x5F55;&#x9879;,&#x5219;&#x672C;&#x5730;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x5C31;&#x76F4;&#x63A5;&#x628A;&#x67E5;&#x8BE2;&#x7684;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x3002;<br>&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;&#x5982;&#x679C;&#x672C;&#x5730;&#x7684;&#x7F13;&#x5B58;&#x4E2D;&#x6CA1;&#x6709;&#x8BE5;&#x7EAA;&#x5F55;,&#x5219;&#x672C;&#x5730;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x5C31;&#x76F4;&#x63A5;&#x628A;&#x8BF7;&#x6C42;&#x53D1;&#x7ED9;&#x6839;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;,&#x7136;&#x540E;&#x6839;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x518D;&#x8FD4;&#x56DE;&#x7ED9;&#x672C;&#x5730;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x4E00;&#x4E2A;&#x6240;&#x67E5;&#x8BE2;&#x57DF;(&#x6839;&#x7684;&#x5B50;&#x57DF;)&#x7684;&#x4E3B;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5730;&#x5740;&#x3002;<br>&#x7B2C;&#x56DB;&#x6B65;&#xFF1A;&#x672C;&#x5730;&#x670D;&#x52A1;&#x5668;&#x518D;&#x5411;&#x4E0A;&#x4E00;&#x6B65;&#x8FD4;&#x56DE;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x9001;&#x8BF7;&#x6C42;,&#x7136;&#x540E;&#x63A5;&#x53D7;&#x8BF7;&#x6C42;&#x7684;&#x670D;&#x52A1;&#x5668;&#x67E5;&#x8BE2;&#x81EA;&#x5DF1;&#x7684;&#x7F13;&#x5B58;,&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BE5;&#x7EAA;&#x5F55;,&#x5219;&#x8FD4;&#x56DE;&#x76F8;&#x5173;&#x7684;&#x4E0B;&#x7EA7;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5730;&#x5740;&#x3002;<br>&#x7B2C;&#x4E94;&#x6B65;&#xFF1A;&#x91CD;&#x590D;&#x7B2C;&#x56DB;&#x6B65;,&#x76F4;&#x5230;&#x627E;&#x5230;&#x6B63;&#x786E;&#x7684;&#x7EAA;&#x5F55;&#x3002;<br>&#x7B2C;&#x516D;&#x6B65;&#xFF1A;&#x672C;&#x5730;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x628A;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x4FDD;&#x5B58;&#x5230;&#x7F13;&#x5B58;,&#x4EE5;&#x5907;&#x4E0B;&#x4E00;&#x6B21;&#x4F7F;&#x7528;,&#x540C;&#x65F6;&#x8FD8;&#x5C06;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;&#x5BA2;&#x6237;&#x673A;&#x3002;     <p></p>
<p></p><h3 id="&#x4E3E;&#x4F8B;&#x8BF4;&#x660E;">&#x4E3E;&#x4F8B;&#x8BF4;&#x660E;</h3><br>&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x7684;&#x5BA2;&#x6237;&#x673A;&#x5982;&#x679C;&#x60F3;&#x8981;&#x8BBF;&#x95EE;&#x7AD9;&#x70B9;&#xFF1A;www.7lw.com , &#x6B64;&#x5BA2;&#x6237;&#x672C;&#x5730;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x662F; dns.company.com , &#x4E00;&#x4E2A;&#x6839;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x662F;NS.INTER.NET , &#x6240;&#x8981;&#x8BBF;&#x95EE;&#x7684;&#x7F51;&#x7AD9;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x662F;dns.7lw.com,&#x57DF;&#x540D;&#x89E3;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#x6240;&#x793A;:<br>(1)&#x5BA2;&#x6237;&#x673A;&#x53D1;&#x51FA;&#x8BF7;&#x6C42;&#x89E3;&#x6790;&#x57DF;&#x540D;www.7lw.com&#x7684;&#x62A5;&#x6587;<br>(2)&#x672C;&#x5730;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x540E;, &#x67E5;&#x8BE2;&#x672C;&#x5730;&#x7F13;&#x5B58;, &#x5047;&#x8BBE;&#x6CA1;&#x6709;&#x8BE5;&#x7EAA;&#x5F55;, &#x5219;&#x672C;&#x5730;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;dns.company.com&#x5219;&#x5411;&#x6839;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;NS.INTER.NET&#x53D1;&#x51FA;&#x8BF7;&#x6C42;&#x89E3;&#x6790;&#x57DF;&#x540D;www.7lw.com<br>(3)&#x6839;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;NS.INTER.NET&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x540E;&#x67E5;&#x8BE2;&#x672C;&#x5730;&#x8BB0;&#x5F55;&#x5F97;&#x5230;&#x5982;&#x4E0B;&#x7ED3;&#x679C;:7lw.com NS dns.7lw.com &#xFF08;&#x8868;&#x793A;7lw.com&#x57DF;&#x4E2D;&#x7684;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x4E3A;&#xFF1A;dns.7lw.com &#xFF09;, &#x540C;&#x65F6;&#x7ED9;&#x51FA;dns.linejet.com&#x7684;&#x5730;&#x5740;,&#x5E76;&#x5C06;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;dns.company.com&#x3002;<br>(4)&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;dns.company.com &#x6536;&#x5230;&#x56DE;&#x5E94;&#x540E;,&#x518D;&#x53D1;&#x51FA;&#x8BF7;&#x6C42;&#x89E3;&#x6790;&#x57DF;&#x540D;www.7lw.com&#x7684;&#x62A5;&#x6587;&#x3002;<br>(5)&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668; dns.7lw.com&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x540E;,&#x5F00;&#x59CB;&#x67E5;&#x8BE2;&#x672C;&#x5730;&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x627E;&#x5230;&#x5982;&#x4E0B;&#x4E00;&#x6761;&#x8BB0;&#x5F55;:www.7lw.com A 211.120.3.12 &#xFF08;&#x8868;&#x793A;7lw.com&#x57DF;&#x4E2D;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;dns.7lw.com&#x7684;IP&#x5730;&#x5740;&#x4E3A;:211.120.3.12&#xFF09;,&#x5E76;&#x5C06;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;&#x5BA2;&#x6237;&#x672C;&#x5730;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;dns.company.com&#x3002;<br>(6)&#x5BA2;&#x6237;&#x672C;&#x5730;&#x57DF;&#x540D;&#x670D;&#x52A1;&#x5668;&#x5C06;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x4FDD;&#x5B58;&#x5230;&#x672C;&#x5730;&#x7F13;&#x5B58;,&#x540C;&#x65F6;&#x5C06;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;&#x5BA2;&#x6237;&#x673A;&#x3002; &#x8FD9;&#x6837;&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x4E00;&#x6B21;&#x57DF;&#x540D;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;.<p></p>
<p></p><h3 id="dns&#x56FE;&#x89E3;">DNS&#x56FE;&#x89E3;</h3><br><img src="/uploads/DNS&#x57DF;&#x540D;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;.jpg" class="blockquote-center"><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;DNS( Domain Name System)是“域名系统”的英文缩写，是一种组织成域层次结构的计算机和网络服务命名系统，它用于TCP/IP网络，它所提供的服务是用来将主机名和域名转换为IP地址的工作。简单点来说，DNS就是一位“翻译官”。&lt;br&gt;
    
    </summary>
    
      <category term="基础" scheme="http://yoursite.com/categories/%E5%9F%BA%E7%A1%80/"/>
    
    
      <category term="DNS" scheme="http://yoursite.com/tags/DNS/"/>
    
  </entry>
  
  <entry>
    <title>网络分析shell脚本(实时流量+连接统计)</title>
    <link href="http://yoursite.com/2016/08/23/%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90shell%E8%84%9A%E6%9C%AC-%E5%AE%9E%E6%97%B6%E6%B5%81%E9%87%8F-%E8%BF%9E%E6%8E%A5%E7%BB%9F%E8%AE%A1/"/>
    <id>http://yoursite.com/2016/08/23/网络分析shell脚本-实时流量-连接统计/</id>
    <published>2016-08-23T03:14:10.000Z</published>
    <updated>2016-08-23T03:29:34.963Z</updated>
    
    <content type="html"><![CDATA[<p>&#x4ECB;&#x7ECD;&#x4E00;&#x4E2A;&#x5F3A;&#x5927;&#x7684;&#x5206;&#x6790;&#x7F51;&#x7EDC;&#x7684;shell&#x811A;&#x672C;</p>
<p></p><h3 id="&#x6B64;&#x811A;&#x672C;&#x5305;&#x542B;&#x7684;&#x529F;&#x80FD;&#x6709;">&#x6B64;&#x811A;&#x672C;&#x5305;&#x542B;&#x7684;&#x529F;&#x80FD;&#x6709;&#xFF1A;</h3><p></p>
<ul>
<li>&#x5B9E;&#x65F6;&#x76D1;&#x63A7;&#x4EFB;&#x610F;&#x7F51;&#x5361;&#x7684;&#x6D41;&#x91CF;</li>
<li>&#x7EDF;&#x8BA1;10&#x79D2;&#x5185;&#x5E73;&#x5747;&#x6D41;&#x91CF;<a id="more"></a></li>
<li>&#x7EDF;&#x8BA1;&#x6BCF;&#x4E2A;&#x7AEF;&#x53E3;&#x5728;10&#x79D2;&#x5185;&#x7684;&#x5E73;&#x5747;&#x6D41;&#x91CF;&#xFF0C;&#x57FA;&#x4E8E;&#x5BA2;&#x6237;&#x7AEF;&#x548C;&#x670D;&#x52A1;&#x7AEF;&#x7AEF;&#x53E3;&#x7EDF;&#x8BA1;&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x54EA;&#x4E9B;&#x7AEF;&#x53E3;&#x5360;&#x6D41;&#x91CF;&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x5BF9;&#x4E8E;web&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4E00;&#x822C;&#x662F;80&#x7AEF;&#x53E3;&#x3002;&#x5176;&#x5B83;&#x7AEF;&#x53E3;&#x53D7;&#x5230;&#x653B;&#x51FB;&#x65F6;&#xFF0C;&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x5176;&#x5B83;&#x7AEF;&#x53E3;&#x6D41;&#x91CF;&#x6BD4;&#x8F83;&#x5927;&#x3002;&#x6240;&#x4EE5;&#x6B64;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x7AEF;&#x53E3;&#x6D41;&#x91CF;&#x662F;&#x5426;&#x6B63;&#x5E38;&#x3002;</li>
<li>&#x7EDF;&#x8BA1;&#x5728;10s&#x5185;&#x5360;&#x7528;&#x5E26;&#x5BBD;&#x6700;&#x5927;&#x7684;&#x524D;10&#x4E2A;ip&#x3002;&#x6B64;&#x9879;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x6765;&#x67E5;&#x51FA;&#x662F;&#x5426;&#x6709;&#x6076;&#x610F;&#x5360;&#x7528;&#x5E26;&#x5BBD;&#x7684;ip&#x3002;</li>
<li>&#x7EDF;&#x8BA1;&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#x3002;&#x6B64;&#x9879;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x51FA;&#x54EA;&#x4E9B;&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#x6BD4;&#x8F83;&#x5927;&#x3002;&#x5982;&#x679C;SYN-RECV&#x72B6;&#x6001;&#x6BD4;&#x8F83;&#x591A;&#x7684;&#x8BDD;&#xFF0C;&#x6709;&#x53EF;&#x4EE5;&#x53D7;&#x5230;&#x534A;&#x8FDE;&#x63A5;&#x653B;&#x51FB;&#x3002;&#x5982;&#x679C;ESTABLISED&#x975E;&#x5E38;&#x5927;&#xFF0C;&#x4F46;&#x901A;&#x8FC7;&#x65E5;&#x5FD7;&#x53D1;&#x73B0;&#x6CA1;&#x6709;&#x90A3;&#x4E48;&#x591A;&#x8BF7;&#x6C42;&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7;tcpdump&#x53D1;&#x73B0;&#x5927;&#x91CF;ip&#x53EA;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x4E0D;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x53D7;&#x5230;&#x4E86;&#x5168;&#x8FDE;&#x63A5;&#x653B;&#x51FB;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x5982;&#x679C;&#x4F60;&#x4F7F;&#x7528;&#x7684;&#x662F;nginx&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x589E;&#x52A0;listen 80 deferred&#x6765;&#x9632;&#x6B62;&#x3002;</li>
<li>&#x7EDF;&#x8BA1;&#x5404;&#x7AEF;&#x53E3;&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#x3002;&#x5F53;&#x53EF;&#x80FD;&#x53D7;&#x5230;&#x653B;&#x51FB;&#x65F6;&#xFF0C;&#x6B64;&#x9879;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x662F;&#x54EA;&#x4E2A;&#x7AEF;&#x53E3;&#x53D7;&#x5230;&#x653B;&#x51FB;&#x3002;</li>
<li>&#x7EDF;&#x8BA1;&#x7AEF;&#x53E3;&#x4E3A;80&#x4E14;&#x72B6;&#x6001;&#x4E3A;ESTAB&#x8FDE;&#x63A5;&#x6570;&#x6700;&#x591A;&#x7684;&#x524D;10&#x4E2A;IP&#x3002;&#x6B64;&#x9879;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x6765;&#x627E;&#x51FA;&#x521B;&#x5EFA;&#x8FDE;&#x63A5;&#x8FC7;&#x591A;&#x7684;Ip&#xFF0C;&#x8FDB;&#x800C;&#x5C4F;&#x853D;&#x3002;</li>
<li>&#x7EDF;&#x8BA1;&#x7AEF;&#x53E3;&#x4E3A;80&#x4E14;&#x72B6;&#x6001;&#x4E3A;SYN-RECV&#x8FDE;&#x63A5;&#x6570;&#x6700;&#x591A;&#x7684;&#x524D;10&#x4E2A;IP&#x3002;&#x5F53;&#x53D7;&#x5230;&#x534A;&#x8FDE;&#x63A5;&#x653B;&#x51FB;&#x65F6;&#xFF0C;&#x6B64;&#x9879;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x627E;&#x5230;&#x6076;&#x610F;ip&#x3002;</li>
</ul>
<p></p><h3 id="&#x7528;&#x5230;&#x7684;&#x7F51;&#x7EDC;&#x5206;&#x6790;&#x5DE5;&#x5177;">&#x7528;&#x5230;&#x7684;&#x7F51;&#x7EDC;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;</h3><p></p>
<ul>
<li>tcpdump:&#x6B64;&#x811A;&#x672C;&#x7528;tcpdump&#x6765;&#x7EDF;&#x8BA1;&#x57FA;&#x4E8E;ip&#x6216;&#x57FA;&#x4E8E;&#x7AEF;&#x53E3;&#x7684;&#x6D41;&#x91CF;&#x3002;</li>
<li>ss&#xFF1A; &#x6B64;&#x811A;&#x672C;&#x7528;ss&#x547D;&#x4EE4;&#x6765;&#x7EDF;&#x8BA1;&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#xFF0C;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x53D1;&#x73B0;ss&#x6BD4;netstat&#x9AD8;&#x6548;&#x5F97;&#x591A;&#x3002;</li>
<li>/proc/net/dev&#xFF0C;&#x7528;&#x6765;&#x7EDF;&#x8BA1;&#x6307;&#x5B9A;&#x7F51;&#x5361;&#x7684;&#x6D41;&#x91CF;&#x3002;</li>
</ul>
<p></p><h3 id="&#x4E0B;&#x9762;&#x8D34;&#x51FA;&#x5B8C;&#x6574;&#x4EE3;&#x7801;">&#x4E0B;&#x9762;&#x8D34;&#x51FA;&#x5B8C;&#x6574;&#x4EE3;&#x7801;</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"> </div><div class="line"><span class="comment">#write by zhumaohai(admin#centos.bz)</span></div><div class="line"><span class="comment">#author blog: www.centos.bz</span></div><div class="line"> </div><div class="line"> </div><div class="line"><span class="comment">#&#x663E;&#x793A;&#x83DC;&#x5355;(&#x5355;&#x9009;)</span></div><div class="line"><span class="function"><span class="title">display_menu</span></span>(){</div><div class="line"><span class="built_in">local</span> soft=<span class="variable">$1</span></div><div class="line"><span class="built_in">local</span> prompt=<span class="string">&quot;which <span class="variable">${soft}</span> you&apos;d select: &quot;</span></div><div class="line"><span class="built_in">eval</span> <span class="built_in">local</span> arr=(\<span class="variable">${${soft}</span>_arr[@]})</div><div class="line"><span class="keyword">while</span> <span class="literal">true</span></div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;#################### <span class="variable">${soft}</span> setting ####################\n\n&quot;</span></div><div class="line">    <span class="keyword">for</span> ((i=1;i&lt;=<span class="variable">${#arr[@]}</span>;i++ )); <span class="keyword">do</span> <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;<span class="variable">$i</span>) <span class="variable">${arr[$i-1]}</span>&quot;</span>; <span class="keyword">done</span></div><div class="line">    <span class="built_in">echo</span></div><div class="line">    <span class="built_in">read</span> -p <span class="string">&quot;<span class="variable">${prompt}</span>&quot;</span> <span class="variable">$soft</span></div><div class="line">    <span class="built_in">eval</span> <span class="built_in">local</span> select=\$<span class="variable">$soft</span></div><div class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$select</span>&quot;</span> == <span class="string">&quot;&quot;</span> ] || [ <span class="string">&quot;<span class="variable">${arr[$soft-1]}</span>&quot;</span> == <span class="string">&quot;&quot;</span>  ];<span class="keyword">then</span></div><div class="line">        prompt=<span class="string">&quot;input errors,please input a number: &quot;</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">eval</span> <span class="variable">$soft</span>=<span class="variable">${arr[$soft-1]}</span></div><div class="line">        <span class="built_in">eval</span> <span class="built_in">echo</span> <span class="string">&quot;your selection: \$<span class="variable">$soft</span>&quot;</span>             </div><div class="line">        <span class="built_in">break</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line"><span class="keyword">done</span></div><div class="line">}</div><div class="line"> </div><div class="line"><span class="comment">#&#x628A;&#x5E26;&#x5BBD;bit&#x5355;&#x4F4D;&#x8F6C;&#x6362;&#x4E3A;&#x4EBA;&#x7C7B;&#x53EF;&#x8BFB;&#x5355;&#x4F4D;</span></div><div class="line"><span class="function"><span class="title">bit_to_human_readable</span></span>(){</div><div class="line">    <span class="comment">#input bit value</span></div><div class="line">    <span class="built_in">local</span> trafficValue=<span class="variable">$1</span></div><div class="line"> </div><div class="line">    <span class="keyword">if</span> [[ <span class="variable">${trafficValue%.*}</span> <span class="_">-gt</span> 922 ]];<span class="keyword">then</span></div><div class="line">        <span class="comment">#conv to Kb</span></div><div class="line">        trafficValue=`awk -v value=<span class="variable">$trafficValue</span> <span class="string">&apos;BEGIN{printf &quot;%0.1f&quot;,value/1024}&apos;</span>`</div><div class="line">        <span class="keyword">if</span> [[ <span class="variable">${trafficValue%.*}</span> <span class="_">-gt</span> 922 ]];<span class="keyword">then</span></div><div class="line">            <span class="comment">#conv to Mb</span></div><div class="line">            trafficValue=`awk -v value=<span class="variable">$trafficValue</span> <span class="string">&apos;BEGIN{printf &quot;%0.1f&quot;,value/1024}&apos;</span>`</div><div class="line">            <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">${trafficValue}</span>Mb&quot;</span></div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">${trafficValue}</span>Kb&quot;</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">${trafficValue}</span>b&quot;</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line">}</div><div class="line"> </div><div class="line"><span class="comment">#&#x5224;&#x65AD;&#x5305;&#x7BA1;&#x7406;&#x5DE5;&#x5177;</span></div><div class="line"><span class="function"><span class="title">check_package_manager</span></span>(){</div><div class="line">    <span class="built_in">local</span> manager=<span class="variable">$1</span></div><div class="line">    <span class="built_in">local</span> systemPackage=<span class="string">&apos;&apos;</span></div><div class="line">    <span class="keyword">if</span> cat /etc/issue | grep -q -E -i <span class="string">&quot;ubuntu|debian&quot;</span>;<span class="keyword">then</span></div><div class="line">        systemPackage=<span class="string">&apos;apt&apos;</span></div><div class="line">    <span class="keyword">elif</span> cat /etc/issue | grep -q -E -i <span class="string">&quot;centos|red hat|redhat&quot;</span>;<span class="keyword">then</span></div><div class="line">        systemPackage=<span class="string">&apos;yum&apos;</span></div><div class="line">    <span class="keyword">elif</span> cat /proc/version | grep -q -E -i <span class="string">&quot;ubuntu|debian&quot;</span>;<span class="keyword">then</span></div><div class="line">        systemPackage=<span class="string">&apos;apt&apos;</span></div><div class="line">    <span class="keyword">elif</span> cat /proc/version | grep -q -E -i <span class="string">&quot;centos|red hat|redhat&quot;</span>;<span class="keyword">then</span></div><div class="line">        systemPackage=<span class="string">&apos;yum&apos;</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;unkonw&quot;</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line"> </div><div class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$manager</span>&quot;</span> == <span class="string">&quot;<span class="variable">$systemPackage</span>&quot;</span> ];<span class="keyword">then</span></div><div class="line">        <span class="built_in">return</span> 0</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">return</span> 1</div><div class="line">    <span class="keyword">fi</span>   </div><div class="line">}</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="comment">#&#x5B9E;&#x65F6;&#x6D41;&#x91CF;</span></div><div class="line"><span class="function"><span class="title">realTimeTraffic</span></span>(){</div><div class="line">    <span class="built_in">local</span> eth=<span class="string">&quot;&quot;</span></div><div class="line">    <span class="built_in">local</span> nic_arr=(`ifconfig | grep -E -o <span class="string">&quot;^[a-z0-9]+&quot;</span> | grep -v <span class="string">&quot;lo&quot;</span> | uniq`)</div><div class="line">    <span class="built_in">local</span> nicLen=<span class="variable">${#nic_arr[@]}</span></div><div class="line">    <span class="keyword">if</span> [[ <span class="variable">$nicLen</span> <span class="_">-eq</span> 0 ]]; <span class="keyword">then</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;sorry,I can not detect any network device,please report this issue to author.&quot;</span></div><div class="line">        <span class="built_in">exit</span> 1</div><div class="line">    <span class="keyword">elif</span> [[ <span class="variable">$nicLen</span> <span class="_">-eq</span> 1 ]]; <span class="keyword">then</span></div><div class="line">        eth=<span class="variable">$nic_arr</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        display_menu nic</div><div class="line">        eth=<span class="variable">$nic</span></div><div class="line">    <span class="keyword">fi</span>   </div><div class="line"> </div><div class="line">    <span class="built_in">local</span> clear=<span class="literal">true</span></div><div class="line">    <span class="built_in">local</span> eth_<span class="keyword">in</span>_peak=0</div><div class="line">    <span class="built_in">local</span> eth_out_peak=0</div><div class="line">    <span class="built_in">local</span> eth_<span class="keyword">in</span>=0</div><div class="line">    <span class="built_in">local</span> eth_out=0</div><div class="line"> </div><div class="line">    <span class="keyword">while</span> <span class="literal">true</span>;<span class="keyword">do</span></div><div class="line">        <span class="comment">#&#x79FB;&#x52A8;&#x5149;&#x6807;&#x5230;0:0&#x4F4D;&#x7F6E;</span></div><div class="line">        <span class="built_in">printf</span> <span class="string">&quot;\033[0;0H&quot;</span></div><div class="line">        <span class="comment">#&#x6E05;&#x5C4F;&#x5E76;&#x6253;&#x5370;Now Peak</span></div><div class="line">        [[ <span class="variable">$clear</span> == <span class="literal">true</span> ]] &amp;&amp; <span class="built_in">printf</span> <span class="string">&quot;\033[2J&quot;</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$eth</span>--------Now--------Peak-----------&quot;</span></div><div class="line">        traffic_be=(`awk -v eth=<span class="variable">$eth</span> -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;{if ($0 ~eth){print $3,$11}}&apos;</span> /proc/net/dev`)</div><div class="line">        sleep 2</div><div class="line">        traffic_af=(`awk -v eth=<span class="variable">$eth</span> -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;{if ($0 ~eth){print $3,$11}}&apos;</span> /proc/net/dev`)</div><div class="line">        <span class="comment">#&#x8BA1;&#x7B97;&#x901F;&#x7387;</span></div><div class="line">        eth_<span class="keyword">in</span>=$(( (<span class="variable">${traffic_af[0]}</span>-<span class="variable">${traffic_be[0]}</span>)*8/2 ))</div><div class="line">        eth_out=$(( (<span class="variable">${traffic_af[1]}</span>-<span class="variable">${traffic_be[1]}</span>)*8/2 ))</div><div class="line">        <span class="comment">#&#x8BA1;&#x7B97;&#x6D41;&#x91CF;&#x5CF0;&#x503C;</span></div><div class="line">        [[ <span class="variable">$eth_in</span> <span class="_">-gt</span> <span class="variable">$eth_in_peak</span> ]] &amp;&amp; eth_<span class="keyword">in</span>_peak=<span class="variable">$eth_in</span></div><div class="line">        [[ <span class="variable">$eth_out</span> <span class="_">-gt</span> <span class="variable">$eth_out_peak</span> ]] &amp;&amp; eth_out_peak=<span class="variable">$eth_out</span></div><div class="line">        <span class="comment">#&#x79FB;&#x52A8;&#x5149;&#x6807;&#x5230;2:1</span></div><div class="line">        <span class="built_in">printf</span> <span class="string">&quot;\033[2;1H&quot;</span></div><div class="line">        <span class="comment">#&#x6E05;&#x9664;&#x5F53;&#x524D;&#x884C;</span></div><div class="line">        <span class="built_in">printf</span> <span class="string">&quot;\033[K&quot;</span>   </div><div class="line">        <span class="built_in">printf</span> <span class="string">&quot;%-20s %-20s\n&quot;</span> <span class="string">&quot;Receive:  <span class="variable">$(bit_to_human_readable $eth_in)</span>&quot;</span> <span class="string">&quot;<span class="variable">$(bit_to_human_readable $eth_in_peak)</span>&quot;</span></div><div class="line">        <span class="comment">#&#x6E05;&#x9664;&#x5F53;&#x524D;&#x884C;</span></div><div class="line">        <span class="built_in">printf</span> <span class="string">&quot;\033[K&quot;</span></div><div class="line">        <span class="built_in">printf</span> <span class="string">&quot;%-20s %-20s\n&quot;</span> <span class="string">&quot;Transmit: <span class="variable">$(bit_to_human_readable $eth_out)</span>&quot;</span> <span class="string">&quot;<span class="variable">$(bit_to_human_readable $eth_out_peak)</span>&quot;</span></div><div class="line">        [[ <span class="variable">$clear</span> == <span class="literal">true</span> ]] &amp;&amp; clear=<span class="literal">false</span></div><div class="line">    <span class="keyword">done</span></div><div class="line">}</div><div class="line"> </div><div class="line"><span class="comment">#&#x6D41;&#x91CF;&#x548C;&#x8FDE;&#x63A5;&#x6982;&#x89C8;</span></div><div class="line"><span class="function"><span class="title">trafficAndConnectionOverview</span></span>(){</div><div class="line">    <span class="keyword">if</span> ! <span class="built_in">which</span> tcpdump &gt; /dev/null;<span class="keyword">then</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;tcpdump not found,going to install it.&quot;</span></div><div class="line">        <span class="keyword">if</span> check_package_manager apt;<span class="keyword">then</span></div><div class="line">            apt-get -y install tcpdump</div><div class="line">        <span class="keyword">elif</span> check_package_manager yum;<span class="keyword">then</span></div><div class="line">            yum -y install tcpdump</div><div class="line">        <span class="keyword">fi</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line"> </div><div class="line">    <span class="built_in">local</span> reg=<span class="string">&quot;&quot;</span></div><div class="line">    <span class="built_in">local</span> eth=<span class="string">&quot;&quot;</span></div><div class="line">    <span class="built_in">local</span> nic_arr=(`ifconfig | grep -E -o <span class="string">&quot;^[a-z0-9]+&quot;</span> | grep -v <span class="string">&quot;lo&quot;</span> | uniq`)</div><div class="line">    <span class="built_in">local</span> nicLen=<span class="variable">${#nic_arr[@]}</span></div><div class="line">    <span class="keyword">if</span> [[ <span class="variable">$nicLen</span> <span class="_">-eq</span> 0 ]]; <span class="keyword">then</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;sorry,I can not detect any network device,please report this issue to author.&quot;</span></div><div class="line">        <span class="built_in">exit</span> 1</div><div class="line">    <span class="keyword">elif</span> [[ <span class="variable">$nicLen</span> <span class="_">-eq</span> 1 ]]; <span class="keyword">then</span></div><div class="line">        eth=<span class="variable">$nic_arr</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        display_menu nic</div><div class="line">        eth=<span class="variable">$nic</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line"> </div><div class="line">    <span class="built_in">echo</span> <span class="string">&quot;please wait for 10s to generate network data...&quot;</span></div><div class="line">    <span class="built_in">echo</span></div><div class="line">    <span class="comment">#&#x5F53;&#x524D;&#x6D41;&#x91CF;&#x503C;</span></div><div class="line">    <span class="built_in">local</span> traffic_be=(`awk -v eth=<span class="variable">$eth</span> -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;{if ($0 ~eth){print $3,$11}}&apos;</span> /proc/net/dev`)</div><div class="line">    <span class="comment">#tcpdump&#x76D1;&#x542C;&#x7F51;&#x7EDC;</span></div><div class="line">    tcpdump -v -i <span class="variable">$eth</span> -tnn &gt; /tmp/tcpdump_temp 2&gt;&amp;1 &amp;</div><div class="line">    sleep 10</div><div class="line">    clear</div><div class="line">    <span class="built_in">kill</span> `ps aux | grep tcpdump | grep -v grep | awk <span class="string">&apos;{print $2}&apos;</span>`</div><div class="line"></div><div class="line">    <span class="comment">#10s&#x540E;&#x6D41;&#x91CF;&#x503C;</span></div><div class="line">    <span class="built_in">local</span> traffic_af=(`awk -v eth=<span class="variable">$eth</span> -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;{if ($0 ~eth){print $3,$11}}&apos;</span> /proc/net/dev`)</div><div class="line">    <span class="comment">#&#x6253;&#x5370;10s&#x5E73;&#x5747;&#x901F;&#x7387;</span></div><div class="line">    <span class="built_in">local</span> eth_<span class="keyword">in</span>=$(( (<span class="variable">${traffic_af[0]}</span>-<span class="variable">${traffic_be[0]}</span>)*8/10 ))</div><div class="line">    <span class="built_in">local</span> eth_out=$(( (<span class="variable">${traffic_af[1]}</span>-<span class="variable">${traffic_be[1]}</span>)*8/10 ))</div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mnetwork device <span class="variable">$eth</span> average traffic in 10s: \033[0m&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$eth</span> Receive: <span class="variable">$(bit_to_human_readable $eth_in)</span>/s&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$eth</span> Transmit: <span class="variable">$(bit_to_human_readable $eth_out)</span>/s&quot;</span></div><div class="line">    <span class="built_in">echo</span></div><div class="line"></div><div class="line">    <span class="built_in">local</span> regTcpdump=$(ifconfig | grep -A 1 <span class="variable">$eth</span> | awk -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;$0~/inet addr:/{printf $4&quot;|&quot;}&apos;</span> | sed <span class="_">-e</span> <span class="string">&apos;s/|$//&apos;</span> <span class="_">-e</span> <span class="string">&apos;s/^/(/&apos;</span> <span class="_">-e</span> <span class="string">&apos;s/$/)\\\\\.[0-9]+:/&apos;</span>)</div><div class="line">  </div><div class="line">    <span class="comment">#&#x65B0;&#x65E7;&#x7248;&#x672C;tcpdump&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#x4E0D;&#x4E00;&#x6837;,&#x5206;&#x522B;&#x5904;&#x7406;</span></div><div class="line">    <span class="keyword">if</span> awk <span class="string">&apos;/^IP/{print;exit}&apos;</span> /tmp/tcpdump_temp | grep -q <span class="string">&quot;)$&quot;</span>;<span class="keyword">then</span></div><div class="line">        <span class="comment">#&#x5904;&#x7406;tcpdump&#x6587;&#x4EF6;</span></div><div class="line">        awk <span class="string">&apos;/^IP/{print;getline;print}&apos;</span> /tmp/tcpdump_temp &gt; /tmp/tcpdump_temp2</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="comment">#&#x5904;&#x7406;tcpdump&#x6587;&#x4EF6;</span></div><div class="line">        awk <span class="string">&apos;/^IP/{print}&apos;</span> /tmp/tcpdump_temp &gt; /tmp/tcpdump_temp2</div><div class="line">        sed -i -r <span class="string">&apos;s#(.*: [0-9]+\))(.*)#\1\n    \2#&apos;</span> /tmp/tcpdump_temp2</div><div class="line">    <span class="keyword">fi</span></div><div class="line">    </div><div class="line">    awk <span class="string">&apos;{len=$NF;sub(/\)/,&quot;&quot;,len);getline;print $0,len}&apos;</span> /tmp/tcpdump_temp2 &gt; /tmp/tcpdump</div><div class="line"></div><div class="line">    <span class="comment">#&#x7EDF;&#x8BA1;&#x6BCF;&#x4E2A;&#x7AEF;&#x53E3;&#x5728;10s&#x5185;&#x7684;&#x5E73;&#x5747;&#x6D41;&#x91CF;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32maverage traffic in 10s base on server port: \033[0m&quot;</span></div><div class="line">    awk -F<span class="string">&apos;[ .:]+&apos;</span> -v regTcpdump=<span class="variable">$regTcpdump</span> <span class="string">&apos;{if ($0 ~ regTcpdump){line=&quot;clients &gt; &quot;$8&quot;.&quot;$9&quot;.&quot;$10&quot;.&quot;$11&quot;:&quot;$12}else{line=$2&quot;.&quot;$3&quot;.&quot;$4&quot;.&quot;$5&quot;:&quot;$6&quot; &gt; clients&quot;};sum[line]+=$NF*8/10}END{for (line in sum){printf &quot;%s %d\n&quot;,line,sum[line]}}&apos;</span> /tmp/tcpdump | \</div><div class="line">    sort -k 4 -nr | head -n 10 | <span class="keyword">while</span> <span class="built_in">read</span> a b c d;<span class="keyword">do</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> <span class="variable">$b</span> <span class="variable">$c</span> <span class="variable">$(bit_to_human_readable $d)</span>/s&quot;</span></div><div class="line">    <span class="keyword">done</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[11A&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[50C&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32maverage traffic in 10s base on client port: \033[0m&quot;</span></div><div class="line">    awk -F<span class="string">&apos;[ .:]+&apos;</span> -v regTcpdump=<span class="variable">$regTcpdump</span> <span class="string">&apos;{if ($0 ~ regTcpdump){line=$2&quot;.&quot;$3&quot;.&quot;$4&quot;.&quot;$5&quot;:&quot;$6&quot; &gt; server&quot;}else{line=&quot;server &gt; &quot;$8&quot;.&quot;$9&quot;.&quot;$10&quot;.&quot;$11&quot;:&quot;$12};sum[line]+=$NF*8/10}END{for (line in sum){printf &quot;%s %d\n&quot;,line,sum[line]}}&apos;</span> /tmp/tcpdump | \</div><div class="line">    sort -k 4 -nr | head -n 10 | <span class="keyword">while</span> <span class="built_in">read</span> a b c d;<span class="keyword">do</span></div><div class="line">            <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[50C&quot;</span></div><div class="line">            <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> <span class="variable">$b</span> <span class="variable">$c</span> <span class="variable">$(bit_to_human_readable $d)</span>/s&quot;</span></div><div class="line">    <span class="keyword">done</span>   </div><div class="line">        </div><div class="line">    <span class="built_in">echo</span></div><div class="line"></div><div class="line">    <span class="comment">#&#x7EDF;&#x8BA1;&#x5728;10s&#x5185;&#x5360;&#x7528;&#x5E26;&#x5BBD;&#x6700;&#x5927;&#x7684;&#x524D;10&#x4E2A;ip</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mtop 10 ip average traffic in 10s base on server: \033[0m&quot;</span></div><div class="line">    awk -F<span class="string">&apos;[ .:]+&apos;</span> -v regTcpdump=<span class="variable">$regTcpdump</span> <span class="string">&apos;{if ($0 ~ regTcpdump){line=$2&quot;.&quot;$3&quot;.&quot;$4&quot;.&quot;$5&quot; &gt; &quot;$8&quot;.&quot;$9&quot;.&quot;$10&quot;.&quot;$11&quot;:&quot;$12}else{line=$2&quot;.&quot;$3&quot;.&quot;$4&quot;.&quot;$5&quot;:&quot;$6&quot; &gt; &quot;$8&quot;.&quot;$9&quot;.&quot;$10&quot;.&quot;$11};sum[line]+=$NF*8/10}END{for (line in sum){printf &quot;%s %d\n&quot;,line,sum[line]}}&apos;</span> /tmp/tcpdump | \</div><div class="line">    sort -k 4 -nr | head -n 10 | <span class="keyword">while</span> <span class="built_in">read</span> a b c d;<span class="keyword">do</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> <span class="variable">$b</span> <span class="variable">$c</span> <span class="variable">$(bit_to_human_readable $d)</span>/s&quot;</span></div><div class="line">    <span class="keyword">done</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[11A&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[50C&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mtop 10 ip average traffic in 10s base on client: \033[0m&quot;</span></div><div class="line">    awk -F<span class="string">&apos;[ .:]+&apos;</span> -v regTcpdump=<span class="variable">$regTcpdump</span> <span class="string">&apos;{if ($0 ~ regTcpdump){line=$2&quot;.&quot;$3&quot;.&quot;$4&quot;.&quot;$5&quot;:&quot;$6&quot; &gt; &quot;$8&quot;.&quot;$9&quot;.&quot;$10&quot;.&quot;$11}else{line=$2&quot;.&quot;$3&quot;.&quot;$4&quot;.&quot;$5&quot; &gt; &quot;$8&quot;.&quot;$9&quot;.&quot;$10&quot;.&quot;$11&quot;:&quot;$12};sum[line]+=$NF*8/10}END{for (line in sum){printf &quot;%s %d\n&quot;,line,sum[line]}}&apos;</span> /tmp/tcpdump | \</div><div class="line">    sort -k 4 -nr | head -n 10 | <span class="keyword">while</span> <span class="built_in">read</span> a b c d;<span class="keyword">do</span></div><div class="line">        <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[50C&quot;</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> <span class="variable">$b</span> <span class="variable">$c</span> <span class="variable">$(bit_to_human_readable $d)</span>/s&quot;</span></div><div class="line">    <span class="keyword">done</span> </div><div class="line"></div><div class="line">    <span class="built_in">echo</span></div><div class="line">    <span class="comment">#&#x7EDF;&#x8BA1;&#x8FDE;&#x63A5;&#x72B6;&#x6001;</span></div><div class="line">    <span class="built_in">local</span> regSS=$(ifconfig | grep -A 1 <span class="variable">$eth</span> | awk -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;$0~/inet addr:/{printf $4&quot;|&quot;}&apos;</span> | sed <span class="_">-e</span> <span class="string">&apos;s/|$//&apos;</span>)</div><div class="line">    ss -an | grep -v -E <span class="string">&quot;LISTEN|UNCONN&quot;</span> | grep -E <span class="string">&quot;<span class="variable">$regSS</span>&quot;</span> &gt; /tmp/ss</div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mconnection state count: \033[0m&quot;</span></div><div class="line">    awk <span class="string">&apos;NR&gt;1{sum[$(NF-4)]+=1}END{for (state in sum){print state,sum[state]}}&apos;</span> /tmp/ss | sort -k 2 -nr</div><div class="line">    <span class="built_in">echo</span></div><div class="line">    <span class="comment">#&#x7EDF;&#x8BA1;&#x5404;&#x7AEF;&#x53E3;&#x8FDE;&#x63A5;&#x72B6;&#x6001;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mconnection state count by port base on server: \033[0m&quot;</span></div><div class="line">    awk <span class="string">&apos;NR&gt;1{sum[$(NF-4),$(NF-1)]+=1}END{for (key in sum){split(key,subkey,SUBSEP);print subkey[1],subkey[2],sum[subkey[1],subkey[2]]}}&apos;</span> /tmp/ss | sort -k 3 -nr | head -n 10   </div><div class="line">    <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[11A&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-ne</span> <span class="string">&quot;\033[50C&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mconnection state count by port base on client: \033[0m&quot;</span></div><div class="line">    awk <span class="string">&apos;NR&gt;1{sum[$(NF-4),$(NF)]+=1}END{for (key in sum){split(key,subkey,SUBSEP);print subkey[1],subkey[2],sum[subkey[1],subkey[2]]}}&apos;</span> /tmp/ss | sort -k 3 -nr | head -n 10 | awk <span class="string">&apos;{print &quot;\033[50C&quot;$0}&apos;</span>   </div><div class="line">    <span class="built_in">echo</span>   </div><div class="line">    <span class="comment">#&#x7EDF;&#x8BA1;&#x7AEF;&#x53E3;&#x4E3A;80&#x4E14;&#x72B6;&#x6001;&#x4E3A;ESTAB&#x8FDE;&#x63A5;&#x6570;&#x6700;&#x591A;&#x7684;&#x524D;10&#x4E2A;IP</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mtop 10 ip ESTAB state count at port 80: \033[0m&quot;</span></div><div class="line">    cat /tmp/ss | grep ESTAB | awk -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;{sum[$(NF-2)]+=1}END{for (ip in sum){print ip,sum[ip]}}&apos;</span> | sort -k 2 -nr | head -n 10</div><div class="line">    <span class="built_in">echo</span></div><div class="line">    <span class="comment">#&#x7EDF;&#x8BA1;&#x7AEF;&#x53E3;&#x4E3A;80&#x4E14;&#x72B6;&#x6001;&#x4E3A;SYN-RECV&#x8FDE;&#x63A5;&#x6570;&#x6700;&#x591A;&#x7684;&#x524D;10&#x4E2A;IP</span></div><div class="line">    <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;\033[32mtop 10 ip SYN-RECV state count at port 80: \033[0m&quot;</span></div><div class="line">    cat /tmp/ss | grep -E <span class="string">&quot;<span class="variable">$regSS</span>&quot;</span> | grep SYN-RECV | awk -F<span class="string">&apos;[: ]+&apos;</span> <span class="string">&apos;{sum[$(NF-2)]+=1}END{for (ip in sum){print ip,sum[ip]}}&apos;</span> | sort -k 2 -nr | head -n 10</div><div class="line">}</div><div class="line"> </div><div class="line"><span class="function"><span class="title">main</span></span>(){</div><div class="line">    <span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span></div><div class="line">        <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;1) real time traffic.\n2) traffic and connection overview.\n&quot;</span></div><div class="line">        <span class="built_in">read</span> -p <span class="string">&quot;please input your select(ie 1): &quot;</span> select</div><div class="line">        <span class="keyword">case</span>  <span class="variable">$select</span> <span class="keyword">in</span></div><div class="line">            1) realTimeTraffic;<span class="built_in">break</span>;;</div><div class="line">            2) trafficAndConnectionOverview;<span class="built_in">break</span>;;</div><div class="line">            *) <span class="built_in">echo</span> <span class="string">&quot;input error,please input a number.&quot;</span>;;</div><div class="line">        <span class="keyword">esac</span></div><div class="line">    <span class="keyword">done</span>   </div><div class="line">}</div><div class="line"> </div><div class="line">main</div></pre></td></tr></table></figure><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;介绍一个强大的分析网络的shell脚本&lt;/p&gt;
&lt;p&gt;&lt;h3&gt;此脚本包含的功能有：&lt;/h3&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;实时监控任意网卡的流量&lt;/li&gt;
&lt;li&gt;统计10秒内平均流量
    
    </summary>
    
      <category term="shell" scheme="http://yoursite.com/categories/shell/"/>
    
    
      <category term="shell" scheme="http://yoursite.com/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>科学上网工具shadowsocks</title>
    <link href="http://yoursite.com/2016/08/22/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E5%B7%A5%E5%85%B7shadowsocks/"/>
    <id>http://yoursite.com/2016/08/22/科学上网工具shadowsocks/</id>
    <published>2016-08-22T09:03:23.000Z</published>
    <updated>2016-08-22T09:59:23.444Z</updated>
    
    <content type="html"><![CDATA[<p>&#x793E;&#x4EA4;&#x7F51;&#x7EDC;&#x7684;&#x51FA;&#x73B0;&#x4F7F;&#x5F97;&#x4F60;&#x8DDF;&#x4F60;&#x559C;&#x6B22;&#x7684;&#x660E;&#x661F;&#x7684;&#x4EA4;&#x8C08;&#x5C31;&#x5728;&#x4E00;&#x4E2A;&#x7559;&#x8A00;&#x4E0A;&#xFF0C;&#x4E0D;&#x50CF;&#x4EE5;&#x524D;&#x90A3;&#x6837;&#xFF0C;&#x5E73;&#x51E1;&#x7684;&#x4EBA;&#x662F;&#x6839;&#x672C;&#x6CA1;&#x6709;&#x6E20;&#x9053;&#x53BB;&#x505A;&#x8FD9;&#x4E9B;&#x4E8B;&#x60C5;&#x7684;&#xFF1B;&#x4ECE;&#x4EE5;&#x524D;&#x7F51;&#x7EDC;&#x7684;&#x865A;&#x5047;&#x5230;&#x73B0;&#x5728;&#x6162;&#x6162;&#x7684;&#x8D8A;&#x6765;&#x8D8A;&#x771F;&#x5B9E;&#xFF0C;&#x4E00;&#x4E2A; ID &#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x5C31;&#x4EE3;&#x8868;&#x7740;&#x771F;&#x5B9E;&#x4E16;&#x754C;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x4EBA;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4E0E;&#x4F60;&#x771F;&#x5B9E;&#x4E16;&#x754C;&#x4E2D;&#x7684;&#x60F3;&#x6CD5;&#x4E00;&#x6837;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x5B8C;&#x5168;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x8FD9;&#x90FD;&#x4E0D;&#x80FD;&#x963B;&#x788D;&#x4F60;&#x6210;&#x4E3A;&#x4E2A;&#x6027;&#x3001;&#x6709;&#x7740;&#x72EC;&#x7ACB;&#x601D;&#x60F3;&#x3001;&#x89C1;&#x89E3;&#x7684;&#x4EBA;&#xFF0C;&#x53EF;&#x662F;&#x751F;&#x6D3B;&#x5728;&#x5929;&#x671D;&#xFF0C;&#x7531;&#x4E8E;&#x79CD;&#x79CD;&#x539F;&#x56E0;&#xFF0C;&#x597D;&#x591A;&#x56FD;&#x5916;&#x4E16;&#x754C;&#x7684;&#x8D44;&#x6E90;&#x4F60;&#x662F;&#x65E0;&#x6CD5;&#x770B;&#x5230;&#x7684;&#xFF0C;&#x4F60;&#x4E0D;&#x80FD;&#x4EAB;&#x53D7;&#x4F60;&#x5E94;&#x8BE5;&#x5F97;&#x5230;&#x7684;&#x8FD9;&#x4E9B;&#xFF08;&#x4F46;&#x662F;&#x6BCF;&#x4E00;&#x4E2A;&#x4E2A;&#x4F53;&#x90FD;&#x6709;&#x76F8;&#x540C;&#x7684;&#x6743;&#x5229;&#x53BB;&#x4EAB;&#x53D7;&#x4E92;&#x8054;&#x7F51;&#x5E26;&#x7ED9;&#x751F;&#x6D3B;&#x4E2D;&#x7684;&#x4FBF;&#x5229;&#xFF09;&#xFF0C;&#x8FD9;&#x662F;&#x5F88;&#x4EE4;&#x4EBA;&#x6124;&#x6068;&#x7684; &#xFF01;&#xFF01; &#x5982;&#x679C;&#x4E0D;&#x80FD;&#x53BB;&#x770B;&#x5230;&#x66F4;&#x591A;&#x7684;&#x98CE;&#x666F;&#xFF0C;&#x53BB;&#x5C1D;&#x8BD5;&#x751F;&#x547D;&#x66F4;&#x591A;&#x7684;&#x53EF;&#x80FD;&#xFF0C;&#x62E5;&#x6709;&#x5E74;&#x8F7B;&#x5FC3;&#x6001;&#x7684;&#x4F60;&#x600E;&#x4E48;&#x4F1A;&#x7518;&#x5FC3;&#xFF1F;<br> <a id="more"></a></p>
<h2 id="&#x4EC0;&#x4E48;&#x662F;shadowsocks">&#x4EC0;&#x4E48;&#x662F;shadowsocks&#xFF1F;</h2><br><em> &#x7801;&#x519C;&#x5BF9;&#x4E8E;shadowsocks&#x5E94;&#x8BE5;&#x4E0D;&#x964C;&#x751F;&#xFF0C;&#x800C;&#x4E00;&#x822C;&#x666E;&#x901A;&#x7F51;&#x6C11;&#x53EF;&#x80FD;&#x77E5;&#x4E4B;&#x751A;&#x5C11;&#x3002;shadowsocks&#x5B9E;&#x8D28;&#x4E0A;&#x4E5F;&#x662F;&#x4E00;&#x79CD;socks5&#x4EE3;&#x7406;&#x670D;&#x52A1;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;ssh&#x4EE3;&#x7406;&#x3002;
</em> &#x4E0E;vpn&#x7684;&#x5168;&#x5C40;&#x4EE3;&#x7406;&#x4E0D;&#x540C;&#xFF0C;shadowsocks&#x4EC5;&#x9488;&#x5BF9;&#x6D4F;&#x89C8;&#x5668;&#x4EE3;&#x7406;&#xFF0C;&#x4E0D;&#x80FD;&#x4EE3;&#x7406;&#x5E94;&#x7528;&#x8F6F;&#x4EF6;&#xFF0C;&#x6BD4;&#x5982;youtube&#x3001;twitter&#x5BA2;&#x6237;&#x7AEF;&#x8F6F;&#x4EF6;&#x3002;<br><em> &#x5982;&#x679C;&#x628A;vpn&#x6BD4;&#x55BB;&#x4E3A;&#x4E00;&#x628A;&#x5C60;&#x9F99;&#x5200;&#xFF0C;&#x90A3;&#x4E48;shadowsocks&#x5C31;&#x662F;&#x4E00;&#x628A;&#x745E;&#x58EB;&#x519B;&#x5200;&#xFF0C;&#x8F7B;&#x5DE7;&#x65B9;&#x4FBF;&#xFF0C;&#x529F;&#x80FD;&#x5374;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#x3002;<br><br><h2 id="shadowsocks-&#x539F;&#x7406;">shadowsocks &#x539F;&#x7406;</h2><br>&#x7B80;&#x5355;&#x7406;&#x89E3;&#x7684;&#x8BDD;&#xFF0C;Shadowsocks&#x662F;&#x5C06;&#x4EE5;&#x524D;&#x901A;&#x8FC7; SSH &#x521B;&#x5EFA;&#x7684; Socks5 &#x534F;&#x8BAE;&#x62C6;&#x5F00;&#x6210; Server &#x7AEF;&#x548C; client &#x7AEF;&#xFF0C;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x539F;&#x7406;&#x56FE;&#x80FD;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x5176;&#x7FFB;&#x5899;&#x539F;&#x7406;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x548C;&#x5229;&#x7528;SSH tunnel&#x5927;&#x81F4;&#x7C7B;&#x4F3C;&#xFF1A;<br><img src="/uploads/what-is-shadowsocks.png" class="blockquote-center"><br>1&#x3001;PC&#x5BA2;&#x6237;&#x7AEF;&#xFF08;&#x5373;&#x4F60;&#x7684;&#x7535;&#x8111;&#xFF09;&#x53D1;&#x51FA;&#x8BF7;&#x6C42;&#x57FA;&#x4E8E; Socks5 &#x534F;&#x8BAE;&#x8DDF; SS-Local &#x7AEF;&#x8FDB;&#x884C;&#x901A;&#x8BAF;&#xFF0C;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A; SS-Local &#x4E00;&#x822C;&#x662F;&#x672C;&#x673A;&#x6216;&#x8DEF;&#x7531;&#x5668;&#x7B49;&#x5C40;&#x57DF;&#x7F51;&#x7684;&#x5176;&#x4ED6;&#x673A;&#x5668;&#xFF0C;&#x4E0D;&#x7ECF;&#x8FC7; GFW&#xFF0C;&#x6240;&#x4EE5;&#x89E3;&#x51B3; GFW &#x901A;&#x8FC7;&#x7279;&#x5F81;&#x5206;&#x6790;&#x8FDB;&#x884C;&#x5E72;&#x6270;&#x7684;&#x95EE;&#x9898;&#x3002;<br>2&#x3001;SS-Local &#x548C; SS-Server &#x4E24;&#x7AEF;&#x901A;&#x8FC7;&#x591A;&#x79CD;&#x53EF;&#x9009;&#x7684;&#x52A0;&#x5BC6;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x901A;&#x8BAF;&#xFF0C;&#x7ECF;&#x8FC7;GFW&#x7684;&#x65F6;&#x5019;&#x56E0;&#x4E3A;&#x662F;&#x5E38;&#x89C4;&#x7684; TCP &#x5305;&#xFF0C;&#x6CA1;&#x6709;&#x660E;&#x663E;&#x7279;&#x5F81;&#x7801; GFW &#x4E5F;&#x65E0;&#x6CD5;&#x5BF9;&#x901A;&#x8BAF;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x89E3;&#x5BC6;&#xFF0C;&#x56E0;&#x6B64;&#x901A;&#x8BAF;&#x653E;&#x884C;&#x3002;<br>3&#x3001;SS-Server &#x5C06;&#x6536;&#x5230;&#x7684;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x89E3;&#x5BC6;&#xFF0C;&#x8FD8;&#x539F;&#x521D;&#x59CB;&#x8BF7;&#x6C42;&#xFF0C;&#x518D;&#x53D1;&#x9001;&#x5230;&#x7528;&#x6237;&#x9700;&#x8981;&#x8BBF;&#x95EE;&#x7684;&#x670D;&#x52A1;&#x7F51;&#x7AD9;&#xFF0C;&#x83B7;&#x53D6;&#x54CD;&#x5E94;&#x539F;&#x8DEF;&#x518D;&#x8FD4;&#x56DE; SS-04&#xFF0C;&#x8FD4;&#x56DE;&#x9014;&#x4E2D;&#x4F9D;&#x7136;&#x4F7F;&#x7528;&#x4E86;&#x52A0;&#x5BC6;&#xFF0C;&#x4F7F;&#x5F97;&#x6D41;&#x91CF;&#x662F;&#x666E;&#x901A; TCP &#x5305;&#xFF0C;&#x5E76;&#x6210;&#x529F;&#x7A7F;&#x8FC7; GFW &#x9632;&#x706B;&#x5899;&#x3002;

</em> &#x8BE6;&#x7EC6;&#x7406;&#x89E3;&#x8BF7;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#x5199;&#x7ED9;&#x975E;&#x4E13;&#x4E1A;&#x4EBA;&#x58EB;&#x770B;&#x7684; <a href="http://vc2tea.com/whats-shadowsocks/" target="_blank" rel="external">Shadowsocks &#x7B80;&#x4ECB;</a>&#xFF0C;&#x4E0D;&#x77E5;&#x9053;GFW&#xFF1F;&#x8BF7;&#x53C2;&#x8003;&#x5F3A;&#x5927;&#x7684;<a href="http://zh.wikipedia.org/wiki/%E9%98%B2%E7%81%AB%E9%95%BF%E5%9F%8E" target="_blank" rel="external">GFW&#x957F;&#x57CE;&#x9632;&#x706B;&#x5899;</a><br><br><h2 id="&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;shadowsocks">&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;shadowsocks&#xFF1F;</h2>

<ul>
<li><p>&#x914D;&#x7F6E;&#x7B80;&#x5355;&#xFF1A;&#x53EA;&#x9700;&#x4E00;&#x6B21;&#x8F93;&#x5165;&#x670D;&#x52A1;&#x5668;ip&#x5730;&#x5740;&#x3001;&#x7AEF;&#x53E3;&#x53F7;&#x3001;&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;&#xFF0C;&#x968F;&#x65F6;&#x5373;&#x53EF;&#x8F7B;&#x677E;&#x4EE3;&#x7406;</p>
</li>
<li><p>&#x8DE8;&#x5E73;&#x53F0;&#xFF1A;window&#x3001;mac&#x3001;Linux&#x3001;ios&#x3001;android&#x5B89;&#x88C5;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x4E00;&#x6837;&#x8F7B;&#x677E;</p>
</li>
</ul>
<p>&#x4E0E;vpn&#x5DEE;&#x5F02;</p>
<table>
<thead>
<tr>
<th>vpn</th>
<th>shadowsocks</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7B80;&#x5355;&#xFF0C;&#x4E00;&#x952E;&#x7FFB;&#x5899;</td>
<td>&#x7B80;&#x5355;&#xFF0C;&#x4E00;&#x952E;&#x7FFB;&#x5899;</td>
</tr>
<tr>
<td>&#x5168;&#x5C40;&#xFF0C;&#x4EE3;&#x7406;&#x6D4F;&#x89C8;&#x5668;&#x3001;&#x5404;&#x79CD;app&#x3001;&#x6240;&#x6709;&#x8D70;&#x7F51;&#x7EDC;&#x7684;&#x90FD;&#x7ECF;&#x8FC7;vpn&#x670D;&#x52A1;&#x5668;</td>
<td>&#x53EA;&#x6709;&#x6D4F;&#x89C8;&#x5668;&#xFF08;&#x53EF;&#x4EE5;&#x624B;&#x52A8;&#x8BBE;&#x7F6E;&#x4EE3;&#x7406;&#x5176;&#x4ED6;app&#xFF09;</td>
</tr>
<tr>
<td>&#x514D;&#x8D39;&#x3001;&#x6536;&#x8D39;&#x670D;&#x52A1;&#x5546;&#x5F88;&#x591A;</td>
<td>&#x514D;&#x8D39;&#x3001;&#x6536;&#x8D39;&#x670D;&#x52A1;&#x5546;&#x5F88;&#x591A;</td>
</tr>
<tr>
<td>&#x901F;&#x5EA6;&#x53EF;&#x4EE5;</td>
<td>&#x901F;&#x5EA6;&#x5F88;&#x5FEB;&#xFF0C;&#x9999;&#x6E2F;&#x3001;&#x65B0;&#x52A0;&#x5761;&#x51E0;&#x5341;&#x6BEB;&#x79D2;</td>
</tr>
<tr>
<td>&#x5E73;&#x53F0;&#x6027;&#x7A0D;&#x5DEE;&#xFF0C;&#x6709;&#x4E9B;&#x505A;&#x7684;&#x4E5F;&#x4E0D;&#x9519;&#x4E86;&#xFF0C;&#x603B;&#x4F53;&#x8DE8;&#x5E73;&#x53F0;&#x6027;&#x5DEE;</td>
<td>&#x652F;&#x6301;&#x5404;&#x5E73;&#x53F0;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x8DE8;&#x5E73;&#x53F0;&#x6027;&#x5F3A;</td>
</tr>
</tbody>
</table>
<ul>
<li><p>vpn&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x6700;&#x75DB;&#x82E6;&#x7684;&#x83AB;&#x8FC7;&#x4E8E;&#xFF0C;&#x516C;&#x53F8;&#x4F7F;&#x7528;vpn&#x3001;&#x5185;&#x7F51;&#x67D0;&#x4E9B;&#x8D44;&#x6E90;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#xFF0C;&#x9700;&#x8981;&#x9891;&#x7E41;&#x5207;&#x6362;vpn&#x4EE3;&#x7406;</p>
</li>
<li><p>shadowsocks&#x51ED;&#x501F;&#x7EF4;&#x62A4;&#x7684;pac&#x6587;&#x4EF6;&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x662F;&#x5426;&#x662F;&#x522B;gfw&#x8FC7;&#x6EE4;&#x57DF;&#x540D;&#xFF0C;&#x662F;&#x7684;&#x8BDD;&#x8D70;&#x4EE3;&#x7406;&#xFF0C;&#x5426;&#x5219;&#x4E0D;&#x8D70;&#x4EE3;&#x7406;&#xFF0C;&#x8FD9;&#x70B9;&#x5F88;&#x65B9;&#x4FBF;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x4F60;&#x53BB;&#x5173;&#x6CE8;&#xFF0C;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x60F3;&#x7740;&#x8BE5;google&#x65F6;&#x5C31;google</p>
</li>
<li>&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x6BD4;&#x5982;&#x4FEE;&#x6539;host&#xFF0C;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x540E;&#x5C31;&#x88AB;&#x548C;&#x8C10;&#x4E86;&#xFF0C;&#x5F88;&#x4E0D;&#x7A33;&#x5B9A;&#xFF1B;GoAgent&#x4E5F;&#x662F;&#xFF0C;&#x4E0D;&#x7A33;&#x5B9A;&#xFF0C;&#x9700;&#x8981;&#x9891;&#x7E41;&#x90E8;&#x7F72;&#x4EE3;&#x7406;&#xFF0C;&#x5176;&#x5B9E;&#x67D0;&#x4E9B;&#x65F6;&#x5019;&#x4F60;&#x53EA;&#x662F;&#x60F3;&#x8981;google&#x4E9B;&#x8D44;&#x6599;&#xFF0C;&#x5374;&#x56E0;&#x5982;&#x4F55;&#x53EF;&#x4EE5;&#x7528;google&#x6D6A;&#x8D39;&#x5927;&#x91CF;&#x65F6;&#x95F4;&#x3002;</li>
</ul>
<p></p><h2 id="&#x5BA2;&#x6237;&#x7AEF;&#x600E;&#x4E48;&#x4F7F;&#x7528;">&#x5BA2;&#x6237;&#x7AEF;&#x600E;&#x4E48;&#x4F7F;&#x7528;&#xFF1F;</h2><p></p>
<ul>
<li>&#x8DE8;&#x5E73;&#x53F0;&#x652F;&#x6301;window&#x3001;mac&#x3001;Android&#x3001;ios&#x3001;wp <a href="https://shadowsocks.com/client.html" target="_blank" rel="external">&#x5BA2;&#x6237;&#x7AEF;&#x4E0B;&#x8F7D;&#x5730;&#x5740;</a> </li>
<li><a href="https://ttt.tt/150/" target="_blank" rel="external">Mac Osx &#x4EE5;&#x53CA; Windows&#x7CFB;&#x7EDF;&#x4E0B;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;</a>&#xFF0C;&#x6CE8;&#x610F;&#x4F7F;&#x7528;&#x6700;&#x65B0;&#x7248;&#x672C;&#x7684;&#x8F6F;&#x4EF6;&#x5DF2;&#x7ECF;&#x4E0D;&#x9700;&#x8981;&#x5728;&#x4F7F;&#x7528; Chrome &#x6D4F;&#x89C8;&#x5668;&#x7684; Proxy SwitchySharp &#x63D2;&#x4EF6;&#x4E86;&#xFF0C;&#x5B89;&#x88C5;&#x914D;&#x7F6E;&#x597D;&#x540E;&#xFF0C;&#x5168;&#x5C40;&#x5373;&#x53EF;&#x4F7F;&#x7528;</li>
</ul>
<p></p><h2 id="&#x8D26;&#x53F7;&#x8D44;&#x6E90;">&#x8D26;&#x53F7;&#x8D44;&#x6E90;</h2><br>shadowsocks &#x5BA2;&#x6237;&#x7AEF;&#x662F;&#x5F88;&#x5F3A;&#x5927;&#x3001;&#x7A33;&#x5B9A;&#x3001;&#x5FEB;&#x901F;&#x7684;&#xFF0C;&#x8DE8;&#x5E73;&#x53F0;&#xFF0C;&#x7701;&#x53BB;&#x5F88;&#x591A;&#x9EBB;&#x70E6;&#xFF0C;&#x4F46;&#x8FD9;&#x4F9D;&#x8D56;&#x4E0E;&#x7A33;&#x5B9A;&#x7684;&#x670D;&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x8D2D;&#x4E70;vps &#xFF0C;&#x642D;&#x5EFA;shadowsocks&#x7684;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#xFF0C;&#x53EA;&#x9700;&#x8981;vps&#x7684;&#x94B1;&#x5373;&#x53EF;&#xFF0C;shadowsocks &#x670D;&#x52A1;&#x7AEF;&#x5F00;&#x6E90;&#x514D;&#x8D39;,&#x53EF;&#x4EE5;&#x53BB;github&#x4E0B;&#x8F7D;&#x642D;&#x5EFA;&#xFF0C;&#x53C2;&#x8003;&#x642D;&#x5EFA;&#x6559;&#x7A0B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x8D2D;&#x4E70;&#x5E02;&#x573A;&#x4E0A;&#x8BB8;&#x591A;&#x670D;&#x52A1;&#x5546;&#x63D0;&#x4F9B;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x76F8;&#x6BD4;&#x81EA;&#x5DF1;&#x642D;&#x5EFA;&#xFF0C;&#x8FD8;&#x5F97;&#x9700;&#x8981;&#x53BB;&#x5173;&#x5FC3;&#x670D;&#x52A1;&#x5668;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x7ECF;&#x6D4E;&#x7684;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5546;&#xFF0C;&#x4FBF;&#x5B9C;&#x7701;&#x4E8B;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5230;&#x7F51;&#x4E0A;&#x5230;&#x5904;&#x641C;&#x5BFB;&#x514D;&#x8D39;&#x7684; shadowsocks&#x8D26;&#x53F7;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#x3002;<p></p>
<p></p><h3 id="&#x514D;&#x8D39;&#x8D26;&#x53F7;&#x7F51;&#x7AD9;&#x63A8;&#x8350;">&#x514D;&#x8D39;&#x8D26;&#x53F7;&#x7F51;&#x7AD9;&#x63A8;&#x8350;</h3><p></p>
<ul>
<li>1.shadowsocks info &#x5206;&#x4EAB;shadowsock&#x76F8;&#x5173;&#x5404;&#x79CD;&#x77E5;&#x8BC6;&#x7684;&#x7F51;&#x7AD9;&#xFF0C;&#x6BD4;&#x8F83;&#x57FA;&#x7840;&#xFF0C;&#x4E5F;&#x6709;&#x5E72;&#x8D27;&#x3002;</li>
<li>2.<a href="https://pan.baidu.com/s/1dEaQmtV" target="_blank" rel="external">&#x5E38;&#x89C1;&#x514D;&#x8D39;ss&#x8D26;&#x53F7;&#x7F51;&#x7AD9;&#x5217;&#x8868;</a> &#x4ECE;&#x5916;&#x9762;&#x7684;&#x7F51;&#x7AD9;&#x4E0A;&#x6574;&#x7406;&#x7684;&#xFF0C;&#x65B9;&#x4FBF;&#x4E0D;&#x80FD;&#x51FA;&#x53BB;&#x7684;&#x7528;&#x6237;&#x67E5;&#x770B;</li>
<li>3.google + shadowsocks&#x7FFB;&#x5899;&#x5708; &#x53EF;&#x4EE5;&#x968F;&#x65F6;&#x83B7;&#x53D6;&#x522B;&#x4EBA;&#x5171;&#x4EAB;&#x7684;&#x514D;&#x8D39;&#x8D26;&#x53F7;(&#x524D;&#x63D0;&#x662F;&#x4F60;&#x5148;&#x80FD;&#x7FFB;&#x5899;)</li>
</ul>
<p>&#x4ECB;&#x7ECD;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x5982;&#x679C;&#x60A8;&#x60F3;&#x4F53;&#x9A8C;&#x4E0B; shadowsocks&#xFF0C;&#x90A3;&#x4E48;&#x5C3D;&#x60C5;&#x7684;&#x4F7F;&#x7528;&#x514D;&#x8D39;&#x8D26;&#x53F7;&#x5427;&#xFF0C;&#x5982;&#x679C;&#x60A8;&#x611F;&#x89C9;&#x5230;&#x4E86;&#x514D;&#x8D39;&#x8D26;&#x53F7;&#x7684;&#x4E0D;&#x7A33;&#x5B9A;&#x7ED9;&#x60A8;&#x5E26;&#x6765;&#x7684;&#x4E0D;&#x65B9;&#x4FBF;&#xFF0C;&#x90A3;&#x4E48;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x4ED8;&#x8D39;&#x670D;&#x52A1;&#xFF0C;&#x6BCF;&#x5E74;&#x53EA;&#x9700;&#x8981;&#x652F;&#x4ED8;&#x4E00;&#x7B14;&#x5F88;&#x5C11;&#x7684;&#x8D39;&#x7528;&#xFF0C;&#x5373;&#x53EF;&#x4EAB;&#x53D7;&#x7545;&#x5FEB;&#x7684;&#x7F51;&#x7EDC;&#xFF0C;&#x5C06;&#x7CBE;&#x529B;&#x653E;&#x5728;&#x5982;&#x4F55;&#x5229;&#x7528;&#x4E0D;&#x53D7;&#x963B;&#x7684;&#x7F51;&#x7EDC;&#x6765;&#x89E3;&#x51B3;&#x81EA;&#x5DF1;&#x7684;&#x95EE;&#x9898;&#x4E0A;&#x9762;&#xFF0C;&#x5C82;&#x4E0D;&#x662F;&#x66F4;&#x6709;&#x610F;&#x4E49;&#xFF1F; &#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x7ED9;&#x5382;&#x5BB6;&#x6253;&#x5E7F;&#x544A;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x767E;&#x5EA6;&#x79D1;&#x5B66;&#x4E0A;&#x7F51;&#x8D26;&#x53F7;&#x5E94;&#x8BE5;&#x80FD;&#x627E;&#x5230;&#x3002;</p>
<ul>
<li>&#x8FD9;&#x91CC;&#x6700;&#x540E;&#x518D;&#x63A8;&#x8350;&#x4E00;&#x4E2A;&#x514D;&#x8D39;&#x7684;<a href="http://www.psiphon3.net/zh/download.html" target="_blank" rel="external">&#x79D1;&#x5B66;&#x4E0A;&#x7F51;&#x7F51;&#x7AD9;</a>&#xFF0C;&#x5C0F;&#x4F19;&#x4F34;&#x4EEC;&#x53EF;&#x4EE5;&#x5C3D;&#x60C5;&#x7684;&#x73A9;&#x800D;&#x53BB;&#x5427;&#x3002;</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;社交网络的出现使得你跟你喜欢的明星的交谈就在一个留言上，不像以前那样，平凡的人是根本没有渠道去做这些事情的；从以前网络的虚假到现在慢慢的越来越真实，一个 ID 在网络上就代表着真实世界中的一个人，你可以与你真实世界中的想法一样当然也可以完全不一样，但这都不能阻碍你成为个性、有着独立思想、见解的人，可是生活在天朝，由于种种原因，好多国外世界的资源你是无法看到的，你不能享受你应该得到的这些（但是每一个个体都有相同的权利去享受互联网带给生活中的便利），这是很令人愤恨的 ！！ 如果不能去看到更多的风景，去尝试生命更多的可能，拥有年轻心态的你怎么会甘心？&lt;br&gt;
    
    </summary>
    
    
      <category term="工具" scheme="http://yoursite.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>KVM迁移时遇到的一些问题</title>
    <link href="http://yoursite.com/2016/08/22/KVM%E8%BF%81%E7%A7%BB%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2016/08/22/KVM迁移时遇到的一些问题/</id>
    <published>2016-08-22T05:00:35.000Z</published>
    <updated>2016-08-22T06:30:56.652Z</updated>
    
    <content type="html"><![CDATA[<p>KVM&#x8FC1;&#x79FB;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x52A8;&#x6001;&#x8FC1;&#x79FB;&#xFF0C;&#x4E00;&#x79CD;&#x4E3A;&#x9759;&#x6001;&#x8FC1;&#x79FB;&#x3002;<br>kvm&#x9759;&#x6001;&#x8FC1;&#x79FB;&#x5C31;&#x662F;&#x865A;&#x62DF;&#x673A;&#x5728;&#x5173;&#x673A;&#x72B6;&#x6001;&#x4E0B;&#xFF0C;&#x62F7;&#x8D1D;&#x865A;&#x62DF;&#x673A;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x4E0E;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5230;&#x76EE;&#x6807;&#x865A;&#x62DF;&#x4E3B;&#x673A;&#x4E2D;&#xFF0C;&#x5B9E;&#x73B0;&#x7684;&#x8FC1;&#x79FB;&#x3002;<br>kvm&#x52A8;&#x6001;&#x8FC1;&#x79FB;&#x65E0;&#x9700;&#x62F7;&#x8D1D;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#xFF0C;&#x9700;&#x8981;&#x76EE;&#x7684;&#x4E3B;&#x673A;&#x548C;&#x6E90;&#x4E3B;&#x673A;&#x6709;&#x76F8;&#x540C;&#x7684;&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#x865A;&#x62DF;&#x673A;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#xFF08;&#x4F9D;&#x8D56;&#x5171;&#x4EAB;&#x5B58;&#x50A8;&#xFF09;&#x3002;<br><a id="more"></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">error:no hypervisor options were found ofr this connection</div><div class="line">this usually means that qemu or kvm is not installed on your machine,or the kvm kernel modules     are not loaded.</div></pre></td></tr></table></figure></p>
<p>  &#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;&#x5F00;&#x542F;bios&#x865A;&#x62DF;&#x5316;&#x5E76;&#x52A0;&#x8F7D;modprobe kvm&#x4EE5;&#x53CA;kvm_intel.</p>
<pre><code class="bash">Unable to migrate guest: unsupported configuration: Domain requires KVM, but it is not  available. Check that virtualization is enabled <span class="keyword">in</span> the host BIOS, and host configuration is setup  to load the kvm modules.
</code></pre>
<p>  &#x89E3;&#x51B3;&#x65B9;&#x6CD5;:&#x65B9;&#x6CD5;&#x540C;&#x4E0A;.</p>
<pre><code class="bash">Unable to migrate guest: Unable to allow access <span class="keyword">for</span> disk path /img/musf-clone1-2-clone.img: No such file or directory
</code></pre>
<p>  &#x89E3;&#x51B3;&#x65B9;&#x6CD5;:&#x8FC1;&#x79FB;&#x4E0E;&#x88AB;&#x8FC1;&#x79FB;&#x4E3B;&#x673A;&#x7684;&#x9700;&#x8981;&#x76F8;&#x540C;&#x540D;&#x79F0;&#x7684;&#x78C1;&#x76D8;&#x6620;&#x50CF;&#x6587;&#x4EF6;<br>  qemu-img create -f raw(&#x78C1;&#x76D8;&#x786C;&#x4EF6;&#x6587;&#x4EF6;&#x683C;&#x5F0F;) /home/kvm-disk/test.img(&#x8DEF;&#x5F84;) 100G(&#x5927;&#x5C0F;)</p>
<pre><code class="bash">Unable to migrate guest: unable to connect to server at <span class="string">&apos;kvm3:49153&apos;</span>: Connection refused
</code></pre>
<p>  &#x89E3;&#x51B3;&#x65B9;&#x6CD5;:1.&#x5F00;&#x542F;&#x9632;&#x706B;&#x5899;&#x4E0A;&#x7AEF;&#x53E3;&#x6216;&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;.<br>           2.&#x5728;virt-manager&#x7684;&#x8FC1;&#x79FB;&#x4E2D;&#x6DFB;&#x52A0;&#x8FC1;&#x79FB;&#x7AEF;&#x53E3;.</p>
<p>&#x5728;ovirt-engine&#x4E2D;&#x6DFB;&#x52A0;data/nfs&#x4F5C;&#x4E3A;&#x5B58;&#x50A8;&#x57DF;&#x65F6;&#x5E76;&#x4E0D;&#x80FD;&#x6210;&#x529F;&#x3002;<br>  &#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;&#x91CD;&#x70B9;&#x67E5;&#x770B;&#x4E00;&#x4E0B;&#x5C06;&#x8981;&#x5171;&#x4EAB;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x6743;&#x9650;&#x662F;&#x5426;&#x662F;vdsm&#xFF1A;kvm&#x3002;&#x82E5;&#x4E0D;&#x662F;&#x4F7F;&#x7528;chown -R&#x547D;&#x4EE4;&#x5373;&#x53EF;&#x3002;  </p>
<p>&#x90E8;&#x5206;&#x4E3B;&#x673A;&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x673A;&#x6210;&#x529F;,&#x5F00;&#x542F;&#x865A;&#x62DF;&#x673A;&#x65F6;&#x51FA;&#x73B0;error&#x2026;</p>
<pre><code class="bash">VM CentOS6.3T is down. Exit message: internal error Process exited <span class="keyword">while</span> reading console <span class="built_in">log</span>      output: <span class="built_in">bind</span>(unix:/var/lib/libvirt/qemu/channels/CentOS6.3T.com.redhat.rhevm.vdsm): Permission    denied chardev: opening backend <span class="string">&quot;socket&quot;</span> failed
</code></pre>
<p>   &#x7531;&#x4E8E;../channels&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x7684;&#x6743;&#x9650;&#x662F;vdsm qemu&#x3002;root&#x7528;&#x6237;&#x53EF;&#x80FD;&#x4E0D;&#x80FD;&#x8BFB;&#x53D6;&#x5E76;&#x521B;&#x5EFA;&#x5176;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x6211;&#x91C7;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x624B;&#x52A8;&#x5728;qemu.conf&#x4E2D;&#x6CE8;&#x91CA;&#x6389;.user = root &#x4EE5;&#x53CA; group = root&#x5E76;&#x91CD;&#x542F;libvirtd&#x3002;<br>   &#x4E4B;&#x540E;&#x51FA;&#x73B0;&#x9519;&#x8BEF;&#xFF1A;</p>
<pre><code class="bash">VM CentOS6.3T is down. Exit message: internal error client socket is closed.
VM <span class="built_in">test</span> is down. Exit message: cannot open file <span class="string">&apos;/rhev/data-center/78e07dee-36bc-439b-b71e-72cfd87a2bb3/f84e3679-281e-41d4-9ea9-b8221085fa7b/images/2e93290e-f1b5-42b2-bdf6-fad695de2ccb/ef334a97-e01b-4d7c-afb0-814ffbe537f0&apos;</span>: Permission denied.
</code></pre>
<p>   &#x8FD9;&#x4E24;&#x4E2A;&#x9519;&#x8BEF;&#x90FD;&#x662F;&#x7531;&#x4E8E;libvirt&#x8BBE;&#x7F6E;&#x95EE;&#x9898;&#x624D;&#x62A5;&#x9519;&#x7684;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x8986;&#x76D6;libvirtd.conf qemu.conf&#x4EE5;&#x53CA;vdsm.conf&#x6587;&#x4EF6;</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;KVM迁移有两种方式，一种是动态迁移，一种为静态迁移。&lt;br&gt;kvm静态迁移就是虚拟机在关机状态下，拷贝虚拟机虚拟磁盘文件与配置文件到目标虚拟主机中，实现的迁移。&lt;br&gt;kvm动态迁移无需拷贝虚拟磁盘文件，需要目的主机和源主机有相同的目录结构虚拟机磁盘文件（依赖共享存储）。&lt;br&gt;
    
    </summary>
    
    
      <category term="KVM" scheme="http://yoursite.com/tags/KVM/"/>
    
  </entry>
  
  <entry>
    <title>磁盘被占满,却找不到大文件</title>
    <link href="http://yoursite.com/2016/08/16/%E7%A3%81%E7%9B%98%E8%A2%AB%E5%8D%A0%E6%BB%A1-%E5%8D%B4%E6%89%BE%E4%B8%8D%E5%88%B0%E5%A4%A7%E6%96%87%E4%BB%B6/"/>
    <id>http://yoursite.com/2016/08/16/磁盘被占满-却找不到大文件/</id>
    <published>2016-08-16T07:29:11.000Z</published>
    <updated>2016-08-16T07:57:57.859Z</updated>
    
    <content type="html"><![CDATA[<p>&#x4E8B;&#x60C5;&#x53D1;&#x751F;&#x5728;&#x4E00;&#x65E5;&#x4E0B;&#x5348;&#xFF0C;&#x7814;&#x53D1;&#x7A81;&#x7136;&#x544A;&#x8BC9;&#x6211;&#x67D0;&#x4E00;&#x53F0;tomcat&#x670D;&#x52A1;&#x5668;&#x7279;&#x522B;&#x5361;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x4E00;&#x8D77;&#x5F00;&#x59CB;&#x8C03;&#x67E5;&#x6574;&#x4EF6;&#x4E8B;&#x60C5;&#x7684;&#x6765;&#x9F99;&#x53BB;&#x8109;&#x3002;<br><a id="more"></a></p>
<p>&#x9996;&#x5148;&#x67E5;&#x770B;&#x7F51;&#x7EDC;&#x6545;&#x969C;&#xFF0C;&#x662F;&#x5426;&#x906D;&#x53D7;&#x653B;&#x51FB;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ss -tanl</div></pre></td></tr></table></figure></p>
<p>&#x67E5;&#x770B;&#x7F51;&#x7EDC;&#x6D41;&#x91CF;&#x6CA1;&#x6709;&#x51FA;&#x73B0;&#x4EFB;&#x4F55;&#x6545;&#x969C;&#xFF0C;&#x6392;&#x9664;&#x4E86;&#x906D;&#x53D7;ddos&#x653B;&#x51FB;&#x7684;&#x53EF;&#x80FD;&#x3002;</p>
<p>&#x5728;&#x5F00;&#x59CB;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x78C1;&#x76D8;&#x51FA;&#x73B0;&#x6545;&#x969C;<br><img src="/uploads/guzhang.png" class="blockquote-center"><br>&#x6545;&#x969C;&#x5DF2;&#x7ECF;&#x5F88;&#x660E;&#x663E;&#x4E86;&#xFF0C;&#x78C1;&#x76D8;&#x5360;&#x6EE1;&#xFF0C;&#x5374;&#x627E;&#x4E0D;&#x5230;&#x5927;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x8FD9;&#x662F;&#x5728;&#x7528;&#x68C0;&#x67E5;&#x53D1;&#x73B0;&#x6709;&#x6587;&#x4EF6;&#x88AB;&#x5220;&#x9664;,&#x800C;&#x8FDB;&#x7A0B;&#x8FD8;&#x6D3B;&#x7740;,&#x56E0;&#x800C;&#x9020;&#x6210;&#x8FD8;&#x5360;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x73B0;&#x8C61;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lsof | grep delete</div></pre></td></tr></table></figure></p>
<p>&#x67E5;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x5F00;&#x53D1;&#x7528;&#x6765;&#x6D4B;&#x8BD5;&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x4E0B;&#x9762;&#x4E00;&#x5927;&#x5806;&#x5B50;&#x8FDB;&#x7A0B;&#xFF09;&#xFF0C;kill&#x6389;&#x8FDB;&#x7A0B;&#x53F7;&#x3002;&#x518D;&#x7528;df&#x547D;&#x4EE4;&#x67E5;&#x770B;&#xFF0C;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x77AC;&#x95F4;&#x56DE;&#x5F52;&#x3002;</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;事情发生在一日下午，研发突然告诉我某一台tomcat服务器特别卡，于是我们一起开始调查整件事情的来龙去脉。&lt;br&gt;
    
    </summary>
    
    
      <category term="故障" scheme="http://yoursite.com/tags/%E6%95%85%E9%9A%9C/"/>
    
  </entry>
  
  <entry>
    <title>Centos6系列安装Zabbix3.0</title>
    <link href="http://yoursite.com/2016/08/16/Centos6%E7%B3%BB%E5%88%97%E5%AE%89%E8%A3%85Zabbix3-0/"/>
    <id>http://yoursite.com/2016/08/16/Centos6系列安装Zabbix3-0/</id>
    <published>2016-08-16T05:26:20.000Z</published>
    <updated>2016-08-16T05:33:35.149Z</updated>
    
    <content type="html"><![CDATA[<p>&#x521A;&#x5F00;&#x59CB;&#x63A5;&#x89E6;zabbix&#x8E29;&#x4E86;&#x65E0;&#x6570;&#x7684;&#x5751;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;centos6&#x7CFB;&#x5217;&#x662F;&#x5B89;&#x88C5;&#x4E0D;&#x4E86;zabbix3.0&#xFF08;yum&#x5B89;&#x88C5;&#xFF09;&#xFF0C;&#x4E8E;&#x662F;&#x5728;github&#x4E0A;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x4E00;&#x4E0B;<a href="https://github.com/zabbixcn/zabbix3.0-rpm.git" target="_blank" rel="external">https://github.com/zabbixcn/zabbix3.0-rpm.git</a><br>&#x672C;&#x6587;&#x4E3B;&#x8981;&#x8BF4;&#x660E;&#x5982;&#x4F55;&#x901A;&#x8FC7;CentOS6(64&#x4F4D;)&#x5B89;&#x88C5;zabbix 3.0<br><a id="more"></a></p>
<p></p><h2 id="&#x73AF;&#x5883;&#x8981;&#x6C42;">&#x73AF;&#x5883;&#x8981;&#x6C42;</h2><br>PHP &gt;= 5.4&#xFF08;&#x9ED8;&#x8BA4;CentOS6 &#x662F;5.3.3&#xFF0C;&#x9700;&#x81EA;&#x5DF1;&#x5B89;&#x88C5;&#xFF09; curl &gt;= 7.20 (&#x5982;&#x9700;&#x652F;&#x6301;SMTP&#x8BA4;&#x8BC1;)<br>git clone <a href="https://github.com/zabbixcn/zabbix3.0-rpm.git" target="_blank" rel="external">https://github.com/zabbixcn/zabbix3.0-rpm.git</a><br>cd  zabbix3.0-rpm/RPMS<p></p>
<p></p><h2 id="&#x5B89;&#x88C5;mysql">&#x5B89;&#x88C5;mysql</h2><br>MySQL&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;5.6&#x7248;&#x672C;&#xFF0C;CentOS6&#x9ED8;&#x8BA4;&#x4E3A;5.1&#xFF0C;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#xFF0C;&#x6027;&#x80FD;&#x504F;&#x4F4E;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">rpm -ivh http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm</div><div class="line">yum install mysql-server -y  <span class="comment">#&#x6B64;&#x8FC7;&#x7A0B;&#x4F1A;&#x56E0;&#x4E3A;&#x7F51;&#x8DEF;&#x95EE;&#x9898;&#x504F;&#x6162;&#xFF0C;&#x8BF7;&#x8010;&#x5FC3;&#x7B49;&#x5F85;</span></div><div class="line">vim /etc/my.cnf</div><div class="line">skip_name_resolve=on</div><div class="line">innodb_file_per_table=on</div><div class="line">mysql</div><div class="line">mysql&gt; CREATE DATABASE zabbix CHARACTER SET utf8 COLLATE utf8_bin;</div><div class="line">mysql&gt; GRANT ALL ON zabbix.* TO <span class="string">&apos;zabbix&apos;</span>@<span class="string">&apos;127.0.0.1&apos;</span> IDENTIFIED BY <span class="string">&apos;zabbix&apos;</span>;</div><div class="line">mysql&gt; FLUSH PRIVILEGES;</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x5B89;&#x88C5;apachephpzabbix-web">&#x5B89;&#x88C5;Apache&#xFF0C;PHP&#xFF0C;Zabbix-Web</h2><br>Zabbix 3.0&#x5BF9;PHP&#x7684;&#x8981;&#x6C42;&#x6700;&#x4F4E;&#x4E3A;5.4&#xFF0C;&#x800C;CentOS6&#x9ED8;&#x8BA4;&#x4E3A;5.3.3&#xFF0C;&#x5B8C;&#x5168;&#x4E0D;&#x6EE1;&#x8DB3;&#x8981;&#x6C42;&#xFF0C;&#x6545;&#x9700;&#x8981;&#x5229;&#x7528;&#x7B2C;&#x4E09;&#x65B9;&#x6E90;&#xFF0C;&#x5C06;PHP&#x5347;&#x7EA7;&#x5230;5.4&#x4EE5;&#x4E0A;&#xFF0C;&#x6CE8;&#x610F;&#xFF0C;&#x4E0D;&#x652F;&#x6301;PHP7<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">rpm -ivh http://repo.webtatic.com/yum/el6/latest.rpm</div><div class="line">yum install zabbix-web-mysql-3.0.0-1.el6.noarch.rpm</div><div class="line">zabbix-web-3.0.0-1.el6.noarch.rpm httpd php56w php56w-gd php56w-mysql</div><div class="line">php56w-bcmath php56w-mbstring php56w-xml php56w-ldap</div><div class="line"></div><div class="line">/etc/init.d/httpd restart</div><div class="line">/etc/init.d/php restart</div><div class="line">sed -i <span class="string">&quot;s@# php_value date.timezone Europe/Riga@php_value date.timezone</span></div><div class="line">Asia/Shanghai@g&quot; /etc/httpd/conf.d/zabbix.conf</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x5B89;&#x88C5;zabbix-server">&#x5B89;&#x88C5;zabbix-server</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">yum  localinstall  zabbix-server-mysql-3.0.0-1.el6.x86_64.rpm</div><div class="line">vi /etc/zabbix/zabbix_server.conf</div><div class="line">DBHost=localhost</div><div class="line">DBName=zabbix</div><div class="line">DBUser=zabbix</div><div class="line">DBPassword=zabbix</div><div class="line"></div><div class="line"><span class="built_in">cd</span> /usr/share/zabbix-server-mysql-3.0.0</div><div class="line">zcat create.sql.gz | mysql -uzabbix -pzabbix zabbix</div><div class="line"></div><div class="line">/etc/init.d/zabbix-server restart</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="zabbix-web&#x754C;&#x9762;&#x914D;&#x7F6E;">zabbix web&#x754C;&#x9762;&#x914D;&#x7F6E;</h2><br><a href="http://${IP}/zabbix" target="_blank" rel="external">http://${IP}/zabbix</a><br>&#x7528;&#x6237;&#xFF1A;Admin   &#x5BC6;&#x7801;:zabbix<p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;刚开始接触zabbix踩了无数的坑，不知道centos6系列是安装不了zabbix3.0（yum安装），于是在github上找到了一个项目，大家可以参考一下&lt;a href=&quot;https://github.com/zabbixcn/zabbix3.0-rpm.git&quot;&gt;https://github.com/zabbixcn/zabbix3.0-rpm.git&lt;/a&gt;&lt;br&gt;本文主要说明如何通过CentOS6(64位)安装zabbix 3.0&lt;br&gt;
    
    </summary>
    
    
      <category term="zabbix" scheme="http://yoursite.com/tags/zabbix/"/>
    
  </entry>
  
  <entry>
    <title>inotify+rsync实时目录同步</title>
    <link href="http://yoursite.com/2016/08/16/inotify-rsync%E5%AE%9E%E6%97%B6%E7%9B%AE%E5%BD%95%E5%90%8C%E6%AD%A5/"/>
    <id>http://yoursite.com/2016/08/16/inotify-rsync实时目录同步/</id>
    <published>2016-08-16T00:48:25.000Z</published>
    <updated>2016-08-16T02:15:26.231Z</updated>
    
    <content type="html"><![CDATA[<!-- toc -->
<!-- tocstop -->
<p></p><h2 id="inotify">inotify</h2><br>Linux&#x5185;&#x6838;&#x4ECE;2.6.13&#x5F00;&#x59CB;&#xFF0C;&#x5F15;&#x5165;&#x4E86;inotify&#x673A;&#x5236;&#x3002;&#x901A;&#x8FC7;intofity&#x673A;&#x5236;&#xFF0C;&#x80FD;&#x591F;&#x5BF9;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x53D8;&#x5316;&#x8FDB;&#x884C;&#x76D1;&#x63A7;&#xFF0C;&#x5982;&#x5BF9;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x521B;&#x5EFA;&#x3001;&#x5220;&#x9664;&#x3001;&#x4FEE;&#x6539;&#x7B49;&#x64CD;&#x4F5C;&#xFF0C;&#x53EF;&#x4EE5;&#x53CA;&#x65F6;&#x901A;&#x77E5;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x76F8;&#x5173;&#x4E8B;&#x4EF6;&#x7684;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x79CD;&#x54CD;&#x5E94;&#x5904;&#x7406;&#x673A;&#x5236;&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x9891;&#x7E41;&#x7684;&#x6587;&#x4EF6;&#x8F6E;&#x8BE2;&#x4EFB;&#x52A1;&#xFF0C;&#x63D0;&#x9AD8;&#x4E86;&#x4EFB;&#x52A1;&#x7684;&#x5904;&#x7406;&#x6548;&#x7387;&#x3002;<br><a id="more"></a><p></p>
<p></p><h2 id="rsync">rsync</h2><br>Rsync &#x662F;&#x4E00;&#x4E2A;&#x8FDC;&#x7A0B;&#x6570;&#x636E;&#x540C;&#x6B65;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x901A;&#x8FC7; LAN/WAN &#x5FEB;&#x901F;&#x540C;&#x6B65;&#x591A;&#x53F0;&#x4E3B;&#x673A;&#x95F4;&#x7684;&#x6587;&#x4EF6;&#x3002;Rsync &#x672C;&#x6765;&#x662F;&#x7528;&#x4EE5;&#x53D6;&#x4EE3;rcp &#x7684;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x5B83;&#x5F53;&#x524D;&#x7531; Rsync.samba.org &#x7EF4;&#x62A4;&#x3002;Rsync &#x4F7F;&#x7528;&#x6240;&#x8C13;&#x7684;&#x201C;Rsync &#x6F14;&#x7B97;&#x6CD5;&#x201D;&#x6765;&#x4F7F;&#x672C;&#x5730;&#x548C;&#x8FDC;&#x7A0B;&#x4E24;&#x4E2A;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x7684;&#x6587;&#x4EF6;&#x8FBE;&#x5230;&#x540C;&#x6B65;&#xFF0C;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x53EA;&#x4F20;&#x9001;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x4E0D;&#x540C;&#x90E8;&#x5206;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6BCF;&#x6B21;&#x90FD;&#x6574;&#x4EFD;&#x4F20;&#x9001;&#xFF0C;&#x56E0;&#x6B64;&#x901F;&#x5EA6;&#x76F8;&#x5F53;&#x5FEB;&#x3002;&#x8FD0;&#x884C; Rsync server &#x7684;&#x673A;&#x5668;&#x4E5F;&#x53EB; backup server&#xFF0C;&#x4E00;&#x4E2A; Rsync server &#x53EF;&#x540C;&#x65F6;&#x5907;&#x4EFD;&#x591A;&#x4E2A; client &#x7684;&#x6570;&#x636E;&#xFF1B;&#x4E5F;&#x53EF;&#x4EE5;&#x591A;&#x4E2A;Rsync server &#x5907;&#x4EFD;&#x4E00;&#x4E2A; client &#x7684;&#x6570;&#x636E;&#x3002;<p></p>
<p>rsync+inotify&#x5219;&#x4F1A;&#x5F25;&#x8865;&#x524D;&#x8005;&#x5148;&#x626B;&#x63CF;&#x540E;&#x540C;&#x6B65;&#x7684;&#x6548;&#x7387;&#x95EE;&#x9898;&#xFF0C;&#x91C7;&#x7528;&#x7CFB;&#x7EDF;&#x7EA7;&#x522B;&#x76D1;&#x63A7;&#x5404;&#x79CD;&#x53D8;&#x5316;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x53D1;&#x751F;&#x4EFB;&#x4F55;&#x53D8;&#x5316;&#xFF0C;&#x5C31;&#x4F1A;&#x89E6;&#x53D1;rsync&#x540C;&#x6B65;&#xFF0C;&#x89E3;&#x51B3;&#x6548;&#x7387;&#x4E0E;&#x5B9E;&#x65F6;&#x6027;&#x95EE;&#x9898;&#x3002;</p>
<p></p><h2 id="&#x914D;&#x7F6E;&#x5B89;&#x88C5;&#x73AF;&#x5883;">&#x914D;&#x7F6E;&#x5B89;&#x88C5;&#x73AF;&#x5883;</h2><br>&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF1A; CentOS 6.7&#xFF08;&#x6700;&#x5C0F;&#x5316;&#x5B89;&#x88C5;&#xFF09;<br>&#x8F6F;&#x4EF6;&#x73AF;&#x5883;&#xFF1A; &#x5DF2;&#x5173;&#x95ED;iptables/selinux<br>rsync&#xFF1A;       rsync-3.1.2.tar.gz(wget <a href="https://download.samba.org/pub/rsync/src/rsync-3.1.2.tar.gz" target="_blank" rel="external">https://download.samba.org/pub/rsync/src/rsync-3.1.2.tar.gz</a>)<br>inotify&#xFF1A;  inotify-tools-3.14.tar.gz(wget <a href="https://cloud.github.com/downloads/rvoicilas/inotify-tools/inotify-tools-3.14.tar.gz" target="_blank" rel="external">https://cloud.github.com/downloads/rvoicilas/inotify-tools/inotify-tools-3.14.tar.gz</a>)<br>rsync-server: 192.168.16.199<br>rsync-client: 192.168.16.119<br>server&#x7AEF;&#x540C;&#x6B65;&#x76EE;&#x5F55;&#xFF1A; /home/data/server (&#x53D1;&#x5E03;&#x6587;&#x4EF6;&#x670D;&#x52A1;&#x5668;)<br>client&#x7AEF;&#x540C;&#x6B65;&#x76EE;&#x5F55;:  /home/data/client (&#x540C;&#x6B65;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x670D;&#x52A1;&#x5668;)<p></p>
<p></p><h2 id="server&#x7AEF;&#x914D;&#x7F6E;">Server&#x7AEF;&#x914D;&#x7F6E;</h2><p></p>
<p></p><h3 id="&#x7F16;&#x8BD1;&#x5B89;&#x88C5;rsync312">&#x7F16;&#x8BD1;&#x5B89;&#x88C5;rsync3.1.2</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@server ~]<span class="comment"># tar -zxf rsync-3.1.2.tar.gz </span></div><div class="line">[root@server ~]<span class="comment"># cd rsync-3.1.2</span></div><div class="line">[root@server rsync-3.1.2]<span class="comment"># ./configure --prefix=/usr/local/rsync(&#x8FD9;&#x91CC;&#x5982;&#x679C;&#x7F16;&#x8BD1;&#x62A5;&#x9519;&#xFF0C;&#x7F3A;&#x4EC0;&#x4E48;&#x7EC4;&#x4EF6;&#x5C31;&#x5B89;&#x88C5;&#x4EC0;&#x4E48;&#x7EC4;&#x4EF6;&#x5373;&#x53EF;)</span></div><div class="line">[root@server rsync-3.1.2]<span class="comment"># make &amp;&amp; make install</span></div></pre></td></tr></table></figure><p></p>
<p></p><h3 id="&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;">&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h3><br>&#x5B89;&#x88C5;&#x540E;rsyncd&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x5728;/etc/rsyncd.conf(&#x9ED8;&#x8BA4;&#x6211;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;&#x662F;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;)<br>&#x7F16;&#x8F91;&#x5220;&#x9664;&#x539F;&#x6709;&#x5185;&#x5BB9;&#x6539;&#x6210;&#x5982;&#x4E0B;&#x5185;&#x5BB9;&#xFF0C;uid&#x53C2;&#x6570;&#x5230;timeout&#x53C2;&#x6570;&#x90E8;&#x5206;&#x4E3A;&#x5168;&#x5C40;&#x53C2;&#x6570;&#xFF0C;[rsyncserver]&#x5F00;&#x59CB;&#x53CA;&#x4EE5;&#x540E;&#x90E8;&#x5206;&#x4E3A;&#x6A21;&#x5757;&#x53C2;&#x6570;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">[root@server ~]<span class="comment"># vim /etc/rsync.conf</span></div><div class="line">uid = root</div><div class="line">gid = root</div><div class="line">port = 873</div><div class="line">max connections = 0</div><div class="line">motd file = /usr/<span class="built_in">local</span>/rsync/rsyncd.motd</div><div class="line"><span class="built_in">log</span> file = /usr/<span class="built_in">local</span>/rsync/rsyncd.log</div><div class="line">pid file = /usr/<span class="built_in">local</span>/rsync/rsyncd.pid</div><div class="line">lock file = /usr/<span class="built_in">local</span>/rsync/rsyncd.lock</div><div class="line">address = 192.168.16.199</div><div class="line">transfer logging = <span class="literal">true</span></div><div class="line"><span class="built_in">log</span> format = %t %a %m %f %b</div><div class="line">timeout = 900</div><div class="line">hosts allow = 192.168.16.119</div><div class="line">hosts deny = *</div><div class="line">syslog facility = <span class="built_in">local</span>3</div><div class="line">dont compress   = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2</div><div class="line"></div><div class="line">[rsyncserver]</div><div class="line">path = /home/data/server</div><div class="line">exclude = lost/ found/</div><div class="line">comment = rsync from 192.168.16.119</div><div class="line">ignore errors</div><div class="line"><span class="built_in">read</span> only = <span class="literal">false</span></div><div class="line">list = <span class="literal">true</span></div><div class="line">use chroot = <span class="literal">false</span></div><div class="line">auth users = rsync_user</div><div class="line">secrets file = /usr/<span class="built_in">local</span>/rsync/rsyncd.secrets</div></pre></td></tr></table></figure><p></p>
<p>&#x65B0;&#x5EFA;rsync&#x7528;&#x6237;&#x540D;&#xFF0C;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x8F93;&#x5165;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF0C;&#x7528;&#x6237;&#x540D;&#x4E0E;&#x5BC6;&#x7801;&#x7528;:&#x5206;&#x5F00;&#xFF0C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x8BBE;&#x4E00;&#x4E2A;&#x7528;&#x6237;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@server ~]<span class="comment"># vim /usr/local/rsync/rsyncd.secrets</span></div><div class="line">rsync_user:123456</div></pre></td></tr></table></figure></p>
<p>&#x8BBE;&#x7F6E;&#x6743;&#x9650;<br>&#x56E0;&#x4E3A;rsyncd.secrets&#x5B58;&#x50A8;&#x4E86;rsync&#x670D;&#x52A1;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x6240;&#x4EE5;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x3002;&#x8981;&#x5C06;rsyncd.secrets&#x8BBE;&#x7F6E;&#x4E3A;root&#x62E5;&#x6709;, &#x6743;&#x9650;&#x4E3A;600<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@server ~]<span class="comment"># chmod 600 /usr/local/rsync/rsyncd.secrets</span></div></pre></td></tr></table></figure></p>
<p></p><h3 id="&#x542F;&#x52A8;&#x670D;&#x52A1;">&#x542F;&#x52A8;&#x670D;&#x52A1;</h3><br>rsync&#x5168;&#x5C40;&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E5F;&#x53EF;&#x5728;&#x6267;&#x884C;rsync&#x65F6;&#x8BBE;&#x503C;&#xFF0C;&#x4F8B;&#x5982;&#x4E0B;<br>&#x2013;daemon  : &#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x6267;&#x884C;rsync<br>&#x2013;address : &#x53CA;&#x2013;port&#x4F5C;&#x7528;&#x53C2;&#x8003;&#x5168;&#x5C40;rsync&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x5168;&#x5C40;&#x53C2;&#x6570;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x4FE9;&#x53C2;&#x6570;&#x53EF;&#x52A0;&#x53EF;&#x4E0D;&#x52A0;<br>&#x2013;config  : &#x6307;&#x5B9A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F4D;&#x7F6E;&#xFF0C;&#x4E0D;&#x52A0;&#x7684;&#x8BDD;&#x9ED8;&#x8BA4;&#x5C31;&#x662F;/etc/rsyncd.conf<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@server ~]<span class="comment"># /usr/local/rsync/bin/rsync --daemon --address=192.168.16.199 --port=873 --config=/etc/rsync.conf </span></div><div class="line">[root@server ~]<span class="comment"># ss -tanl (&#x786E;&#x5B9A;873&#x7AEF;&#x53E3;&#x662F;&#x5426;&#x76D1;&#x542C;)</span></div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="client&#x7AEF;&#x914D;&#x7F6E;">client&#x7AEF;&#x914D;&#x7F6E;</h2><p></p>
<p></p><h3 id="rsync&#x914D;&#x7F6E;">rsync&#x914D;&#x7F6E;</h3><br>&#x8FD9;&#x91CC;&#x540C;&#x6837;&#x5F97;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;rsync-3.1.2(&#x540C;server&#x7AEF;)<br>&#x521B;&#x5EFA;&#x5B58;&#x653E;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x8F93;&#x5165;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x5BC6;&#x7801;&#x5373;&#x53EF;&#xFF0C;&#x4E0D;&#x7528;&#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;<br>&#x8FD9;&#x91CC;&#x586B;&#x5199;&#x4E0A;&#x9762;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x91CC;&#x8BBE;&#x5B9A;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x7528;&#x6237;&#x540D;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x91CC;&#x6307;&#x5B9A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@tomcat4 ~]<span class="comment"># vim /usr/local/rsync/rsyncd.pass</span></div><div class="line">123456</div><div class="line">[root@tomcat4 ~]<span class="comment"># chmod 600 /usr/local/rsync/rsyncd.pass(&#x53EA;&#x80FD;&#x8BBE;&#x6210;600,&#x5426;&#x5219;&#x53EF;&#x80FD;&#x51FA;&#x95EE;&#x9898;)</span></div></pre></td></tr></table></figure><p></p>
<p></p><h3 id="&#x5411;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x4E0A;&#x4F20;&#x540C;&#x6B65;&#x6587;&#x4EF6;">&#x5411;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x4E0A;&#x4F20;&#x540C;&#x6B65;&#x6587;&#x4EF6;</h3><br>/home/data/client          &#x672C;&#x5730;&#x5BA2;&#x6237;&#x7AEF;&#x8981;&#x540C;&#x6B65;&#x7684;&#x6587;&#x4EF6;&#x5939;<br>rsync_user                &#x670D;&#x52A1;&#x5668;&#x7AEF;rsync&#x670D;&#x52A1;&#x4E2D;&#x8BBE;&#x5B9A;&#x5141;&#x8BB8;&#x6267;&#x884C;&#x8BE5;&#x6A21;&#x5757;&#x7684;&#x7528;&#x6237;&#x540D;<br>192.168.16.199            &#x670D;&#x52A1;&#x5668;&#x7AEF;IP&#x5730;&#x5740;<br>::rsyncserver             &#x8868;&#x793A;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x9700;&#x8981;&#x540C;&#x6B65;&#x7684;&#x6A21;&#x5757;&#x540D;&#x79F0;<br>&#x547D;&#x4EE4;&#x884C;&#x53C2;&#x6570;<br>-v : verbose<br>-z : &#x538B;&#x7F29;<br>-r : recursive<br>-t : &#x8868;&#x793A;&#x4FDD;&#x6301;&#x539F;&#x6587;&#x4EF6;&#x521B;&#x5EFA;&#x65F6;&#x95F4;<br>-o : &#x8868;&#x793A;&#x4FDD;&#x6301;&#x539F;&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;<br>-p : &#x8868;&#x793A;&#x4FDD;&#x6301;&#x539F;&#x6587;&#x4EF6;&#x7684;&#x53C2;&#x6570;<br>-g : &#x8868;&#x793A;&#x4FDD;&#x6301;&#x539F;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x5C5E;&#x7EC4;<br>-a : &#x5B58;&#x6863;&#x6A21;&#x5F0F;<br>-P : &#x8868;&#x793A;&#x4EE3;&#x66FF;-partial&#x548C;-progress&#x4E24;&#x8005;&#x7684;&#x9009;&#x9879;&#x529F;&#x80FD;<br>-e : ssh&#x5EFA;&#x7ACB;&#x8D77;&#x52A0;&#x5BC6;&#x7684;&#x8FDE;&#x63A5;&#x3002;<br>&#x2013;partial       : &#x963B;&#x6B62;rsync&#x5728;&#x4F20;&#x8F93;&#x4E2D;&#x65AD;&#x65F6;&#x5220;&#x9664;&#x5DF2;&#x62F7;&#x8D1D;&#x7684;&#x90E8;&#x5206;(&#x5982;&#x679C;&#x5728;&#x62F7;&#x8D1D;&#x6587;&#x4EF6;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4F20;&#x8F93;&#x88AB;&#x4E2D;&#x65AD;&#xFF0C;rsync&#x7684;&#x9ED8;&#x8BA4;&#x64CD;&#x4F5C;&#x662F;&#x64A4;&#x6D88;&#x524D;&#x64CD;&#x4F5C;&#xFF0C;&#x5373;&#x4ECE;&#x76EE;&#x6807;&#x673A;&#x4E0A;&#x5220;&#x9664;&#x5DF2;&#x62F7;&#x8D1D;&#x7684;&#x90E8;&#x5206;&#x6587;&#x4EF6;&#x3002;)<br>&#x2013;progress      : &#x662F;&#x6307;&#x663E;&#x793A;&#x51FA;&#x8BE6;&#x7EC6;&#x7684;&#x8FDB;&#x5EA6;&#x60C5;&#x51B5;<br>&#x2013;delete        : &#x5BA2;&#x6237;&#x7AEF;&#x4E0A;&#x5220;&#x9664;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x4E5F;&#x5220;&#x9664;&#xFF0C;&#x4FDD;&#x6301;&#x771F;&#x6B63;&#x7684;&#x4E00;&#x81F4;&#x3002;<br>&#x2013;exclude       : &#x4E0D;&#x5305;&#x542B;/ins&#x76EE;&#x5F55;<br>&#x2013;size-only     : &#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7528;&#x5728;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x7684;&#x5DEE;&#x522B;&#x4EC5;&#x662F;&#x6E90;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x6709;&#x4E00;&#x4E9B;&#x65B0;&#x6587;&#x4EF6;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x91CD;&#x540D;&#x4E14;&#x88AB;&#x4FEE;&#x6539;&#x8FC7;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x79CD;&#x6587;&#x4EF6;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x56E0;&#x4E3A;&#x5185;&#x5BB9;&#x88AB;&#x4FEE;&#x6539;&#x53EF;&#x5927;&#x5C0F;&#x4E00;&#x6837;&#xFF0C;&#x800C;&#x88AB;&#x7565;&#x8FC7;&#x3002;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x5927;&#x5927;&#x5730;&#x63D0;&#x9AD8;&#x540C;&#x6B65;&#x7684;&#x6548;&#x7387;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4E0D;&#x9700;&#x8981;&#x68C0;&#x67E5;&#x540C;&#x540D;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x76F8;&#x540C;&#x3002;<br>&#x2013;password-file : &#x6307;&#x5B9A;&#x5305;&#x542B;server&#x7AEF;&#x8BA4;&#x8BC1;&#x7528;&#x6237;&#x7684;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#xFF0C;&#x4E0D;&#x52A0;&#x6B64;&#x9009;&#x9879;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x65F6;&#x4F1A;&#x63D0;&#x793A;&#x624B;&#x52A8;&#x8F93;&#x5165;&#x5BC6;&#x7801;&#x3002;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[root@tomcat4 ~]<span class="comment"># mkdir /home/data/client</span></div><div class="line">[root@tomcat4 ~]<span class="comment"># touch 123 //home/data/client/test.txt</span></div><div class="line">[root@tomcat4 ~]<span class="comment"># /usr/local/rsync/bin/rsync -vzrtopg --delete --progress --password-file=/usr/local/rsync/rsyncd.pass /home/data/client/ rsync_user@192.168.16.199::rsyncserver</span></div><div class="line"></div><div class="line">sending incremental file list</div><div class="line">./</div><div class="line">test.txt</div><div class="line">              0 100%    0.00kB/s    0:00:00 (xfr<span class="comment">#1, to-chk=0/2)</span></div><div class="line"></div><div class="line">sent 112 bytes  received 46 bytes  316.00 bytes/sec</div><div class="line">total size is 0  speedup is 0.00</div></pre></td></tr></table></figure><p></p>
<p>&#x6267;&#x884C;&#x5B8C;&#x4E4B;&#x540E;&#x53EF;&#x5230;server&#x7AEF;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x540C;&#x6B65;</p>
<p></p><h3 id="&#x7F16;&#x8BD1;&#x5B89;&#x88C5;inotify">&#x7F16;&#x8BD1;&#x5B89;&#x88C5;inotify</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@server ~]<span class="comment"># tar -zxf inotify-tools-3.14.tar.gz </span></div><div class="line">[root@server ~]<span class="comment"># cd inotify-tools-3.14</span></div><div class="line">[root@server inotify-tools-3.14]<span class="comment"># ./configure --prefix=/usr/local/inotify (&#x9700;&#x8981;&#x5148;&#x5B89;&#x88C5;gcc&#x4E0E;gcc-c++)</span></div></pre></td></tr></table></figure><p></p>
<p>&#x7F16;&#x5199;&#x6267;&#x884C;inotify&#x7684;&#x811A;&#x672C;&#x586B;&#x5199;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF0C;&#x4F7F;inotify&#x5B9E;&#x65F6;&#x76D1;&#x63A7;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x5E76;&#x505A;&#x76F8;&#x5E94;&#x64CD;&#x4F5C;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">[root@tomcat4 ~]<span class="comment"># vim /usr/local/inotify/inotify.sh</span></div><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"><span class="comment">#&#x540C;&#x6B65;&#x63A5;&#x6536;&#x65B9;ip</span></div><div class="line">client=192.168.16.199</div><div class="line"><span class="comment">#&#x672C;&#x5730;&#x8981;&#x76D1;&#x89C6;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x8DEF;&#x5F84;</span></div><div class="line"><span class="built_in">local</span>_folder=/home/data/client/</div><div class="line"><span class="comment">#&#x540C;&#x6B65;&#x63A5;&#x6536;&#x65B9;&#x914D;&#x7F6E;&#x7684;rsync&#x6A21;&#x5757;&#x540D;</span></div><div class="line">module=rsyncserver</div><div class="line"><span class="comment">#&#x540C;&#x6B65;&#x63A5;&#x6536;&#x65B9;&#x9274;&#x6743;&#x65F6;&#x7684;&#x7528;&#x6237;</span></div><div class="line">user=rsync_user</div><div class="line">/usr/<span class="built_in">local</span>/inotify/bin/inotifywait -mrq --timefmt <span class="string">&apos;%d/%m/%y %H:%M&apos;</span> --format <span class="string">&apos;%T %w%f%e&apos;</span> <span class="_">-e</span> create,move,delete,modify,attrib <span class="variable">$local_folder</span> | <span class="keyword">while</span> <span class="built_in">read</span> files</div><div class="line"><span class="keyword">do</span></div><div class="line">/usr/<span class="built_in">local</span>/rsync/bin/rsync -vzrtopg --delete --progress --password-file=/usr/<span class="built_in">local</span>/rsync/rsyncd.pass  <span class="variable">$local_folder</span> <span class="variable">$user</span>@<span class="variable">$client</span>::<span class="variable">$module</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>inotify&#x90E8;&#x5206;&#x53C2;&#x6570;<br>-m &#x662F;&#x4FDD;&#x6301;&#x4E00;&#x76F4;&#x76D1;&#x542C;<br>-r &#x662F;&#x9012;&#x5F52;&#x67E5;&#x770B;&#x76EE;&#x5F55;<br>-q &#x662F;&#x6253;&#x5370;&#x51FA;&#x4E8B;&#x4EF6;<br>-e create,move,delete,modify,attrib &#x662F;&#x6307; &#x76D1;&#x542C;&#x201C;&#x521B;&#x5EFA; &#x79FB;&#x52A8; &#x5220;&#x9664; &#x4FEE;&#x6539; &#x5C5E;&#x6027;&#x201D; &#x4E8B;&#x4EF6;</p>
<p>&#x8BBE;&#x7F6E;&#x811A;&#x672C;&#x6743;&#x9650;&#x5E76;&#x540E;&#x53F0;&#x542F;&#x52A8;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@tomcat4 ~]<span class="comment"># chmod 755 /usr/local/inotify/inotify.sh</span></div><div class="line">[root@tomcat4 client]<span class="comment"># /usr/local/inotify/inotify.sh &amp; (&#x8FD9;&#x65F6;&#x53EF;&#x968F;&#x4FBF;&#x5728;&#x76D1;&#x63A7;&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;)</span></div></pre></td></tr></table></figure></p>
<p>&#x5C06;&#x6B64;&#x811A;&#x672C;&#x52A0;&#x5165;&#x5230;&#x5F00;&#x673A;&#x81EA;&#x542F;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@tomcat4 client]<span class="comment"># vim /etc/rc.d/rc.local</span></div><div class="line">/usr/<span class="built_in">local</span>/inotify/inotify.sh &amp;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&#x9644;&#x5F55;</div><div class="line">uid = root                                                   <span class="comment"># &#x8FD0;&#x884C;rsync&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7684;&#x7528;&#x6237;</span></div><div class="line">gid = root                                                   <span class="comment"># &#x8FD0;&#x884C;rsync&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7684;&#x7EC4;</span></div><div class="line">port = 873                                                   <span class="comment"># &#x9ED8;&#x8BA4;&#x7AEF;&#x53E3;873</span></div><div class="line">max connections = 0                                          <span class="comment"># &#x6700;&#x5927;&#x8FDE;&#x63A5;&#x6570;&#x65E0;&#x9650;&#x5236;&#xFF0C;&#x6307;&#x5B9A;&#x8BE5;&#x6A21;&#x5757;&#x7684;&#x6700;&#x5927;&#x5E76;&#x53D1;&#x8FDE;&#x63A5;&#x6570;&#x91CF;&#x4EE5;&#x4FDD;&#x62A4;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x8D85;&#x8FC7;&#x9650;&#x5236;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x5C06;&#x88AB;&#x544A;&#x77E5;&#x968F;&#x540E;&#x518D;&#x8BD5;&#x3002;</span></div><div class="line">motd file = /usr/<span class="built_in">local</span>/rsync/rsyncd.motd                     <span class="comment"># &#x7528;&#x6765;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x6587;&#x4EF6;&#xFF0C;&#x5F53;&#x5BA2;&#x6237;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;&#x65F6;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x663E;&#x793A;&#x7ED9;&#x5BA2;&#x6237;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x6CA1;&#x6709;motd&#x6587;&#x4EF6;&#x7684;&#x3002;</span></div><div class="line"><span class="built_in">log</span> file = /usr/<span class="built_in">local</span>/rsync/rsyncd.log                       <span class="comment"># &#x6307;&#x5B9A; rsync &#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x7684;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x4F4D;&#x7F6E;&#xFF0C;&#x800C;&#x4E0D;&#x5C06;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x7ED9; syslog&#x3002;</span></div><div class="line">pid file = /usr/<span class="built_in">local</span>/rsync/rsyncd.pid                       <span class="comment"># &#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x5C06;&#x5176; PID&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7684;&#x5B58;&#x653E;&#x4F4D;&#x7F6E;</span></div><div class="line">lock file = /usr/<span class="built_in">local</span>/rsync/rsyncd.lock                     <span class="comment"># &#x6307;&#x5B9A;&#x652F;&#x6301; max connections &#x53C2;&#x6570;&#x7684;&#x9501;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x4F4D;&#x7F6E;&#x3002;</span></div><div class="line">address = 192.168.155.131                                    <span class="comment"># &#x5728;&#x72EC;&#x7ACB;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x5C06;&#x6B64;&#x670D;&#x52A1;&#x7ED1;&#x5B9A;&#x5230;&#x6307;&#x5B9A;&#x7684; IP &#x5730;&#x5740;&#x8FD0;&#x884C;&#xFF08;&#x8FD9;&#x91CC;&#x4E5F;&#x5C31;&#x662F;&#x672C;&#x673A;IP&#x5730;&#x5740;&#xFF09;&#x3002;&#x7531; xinetd &#x8FD0;&#x884C;&#x65F6;&#x5C06;&#x5FFD;&#x7565;&#x6B64;&#x53C2;&#x6570;&#xFF0C;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x4E0A;&#x7684; --address &#x9009;&#x9879;&#x66FF;&#x4EE3;&#x3002;</span></div><div class="line">transfer logging = <span class="literal">true</span>                                      <span class="comment"># &#x4F7F; rsync &#x670D;&#x52A1;&#x5668;&#x5C06;&#x4F20;&#x8F93;&#x64CD;&#x4F5C;&#x8BB0;&#x5F55;&#x5230;&#x4F20;&#x8F93;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x3002;</span></div><div class="line"><span class="built_in">log</span> format = %t %a %m %f %b                                  <span class="comment"># &#x901A;&#x8FC7;&#x8BE5;&#x9009;&#x9879;&#x7528;&#x6237;&#x5728;&#x4F7F;&#x7528;transfer logging&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x5B9A;&#x5236;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x7684;&#x5B57;&#x6BB5;&#x3002;&#x5176;&#x683C;&#x5F0F;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x683C;&#x5F0F;&#x5B9A;&#x4E49;&#x7B26;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x683C;&#x5F0F;&#x5B9A;&#x4E49;&#x7B26;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</span></div><div class="line">timeout = 900                                                <span class="comment"># &#x5355;&#x4F4D;&#x79D2;&#xFF0C;&#x8BE5;&#x9009;&#x9879;&#x53EF;&#x4EE5;&#x8986;&#x76D6;&#x5BA2;&#x6237;&#x6307;&#x5B9A;&#x7684; IP &#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x3002;&#x4ECE;&#x800C;&#x786E;&#x4FDD; rsync &#x670D;&#x52A1;&#x5668;&#x4E0D;&#x4F1A;&#x6C38;&#x8FDC;&#x7B49;&#x5F85;&#x4E00;&#x4E2A;&#x5D29;&#x6E83;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x3002;</span></div><div class="line">hosts allow = 192.168.155.130 192.168.155.129                <span class="comment"># &#x8FD0;&#x884C;&#x8BBF;&#x95EE;&#x672C;rsync&#x670D;&#x52A1;&#x5668;&#x7684;IP&#x5730;&#x5740;&#xFF0C;&#x6216;&#x7F51;&#x6BB5;&#xFF0C;&#x6216;&#x8005;&#x7528;*&#x8868;&#x793A;&#x5141;&#x8BB8;&#x5168;&#x90E8;,&#x591A;IP&#x7528;&#x7A7A;&#x683C;&#x5206;&#x9694;</span></div><div class="line">hosts deny = *                                               <span class="comment"># &#x4E0D;&#x5141;&#x8BB8;&#x8BBF;&#x95EE;&#x672C;rsync&#x670D;&#x52A1;&#x5668;&#x7684;IP&#x5730;&#x5740;&#xFF0C;&#x8D4B;&#x503C;&#x89C4;&#x5219;&#x540C;hosts allow</span></div><div class="line">syslog facility = <span class="built_in">local</span>3                                     <span class="comment"># &#x6307;&#x5B9A;rsync&#x53D1;&#x9001;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x7ED9;syslog&#x65F6;&#x7684;&#x6D88;&#x606F;&#x7EA7;&#x522B;&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x6D88;&#x606F;&#x7EA7;&#x522B;&#x662F;&#xFF1A;uth, authpriv, cron, daemon, ftp, kern, lpr, mail, news, security, sys-log, user, uucp, local0, local1, local2, local3,local4, local5, local6&#x548C;local7&#x3002;&#x9ED8;&#x8BA4;&#x503C;&#x662F;daemon&#x3002;</span></div><div class="line">dont compress   = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2 <span class="comment"># &#x7528;&#x6765;&#x6307;&#x5B9A;&#x90A3;&#x4E9B;&#x5728;&#x4F20;&#x8F93;&#x4E4B;&#x524D;&#x4E0D;&#x8FDB;&#x884C;&#x538B;&#x7F29;&#x5904;&#x7406;&#x7684;&#x6587;&#x4EF6;&#x3002;</span></div><div class="line"></div><div class="line">[rsyncserver]                                                <span class="comment"># &#x8FD9;&#x91CC;&#x662F;&#x8BA4;&#x8BC1;&#x7684;&#x6A21;&#x5757;&#x540D;&#xFF0C;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#xFF08;&#x8FD9;&#x91CC;&#x662F;Apache&#x670D;&#x52A1;&#x5668;&#xFF09;&#x7AEF;&#x9700;&#x8981;&#x6307;&#x5B9A;</span></div><div class="line">path = /usr/<span class="built_in">local</span>/nginx/html/                                <span class="comment"># &#x9700;&#x8981;&#x505A;&#x955C;&#x50CF;&#x7684;&#x76EE;&#x5F55;</span></div><div class="line">exclude = lost/ found/                                       <span class="comment"># &#x4E0D;&#x5305;&#x542B;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x591A;&#x76EE;&#x5F55;&#x7528;&#x7A7A;&#x683C;&#x5206;&#x5F00;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x4E0D;&#x540C;&#x6B65;/usr/local/nginx/html/&#x76EE;&#x5F55;&#x4E0B;&#x7684;lost/&#x548C;found/&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x5939;</span></div><div class="line">comment = rsync from 192.168.155.130                         <span class="comment"># &#x7ED9;&#x6A21;&#x5757;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x63CF;&#x8FF0;&#xFF0C;&#x8BE5;&#x63CF;&#x8FF0;&#x8FDE;&#x540C;&#x6A21;&#x5757;&#x540D;&#x5728;&#x5BA2;&#x6237;&#x8FDE;&#x63A5;&#x5F97;&#x5230;&#x6A21;&#x5757;&#x5217;&#x8868;&#x65F6;&#x663E;&#x793A;&#x7ED9;&#x5BA2;&#x6237;</span></div><div class="line">ignore errors                                                <span class="comment"># &#x5FFD;&#x7565;&#x9519;&#x8BEF;</span></div><div class="line"><span class="built_in">read</span> only = <span class="literal">false</span>                                            <span class="comment"># &#x6307;&#x5B9A;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x5BA2;&#x6237;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x3002;&#x82E5;&#x4E3A; true &#x5219;&#x4E0D;&#x5141;&#x8BB8;&#x4E0A;&#x4F20;&#xFF1B;&#x82E5;&#x4E3A; false &#x5E76;&#x4E14;&#x670D;&#x52A1;&#x5668;&#x76EE;&#x5F55;&#x4E5F;&#x5177;&#x6709;&#x8BFB;&#x5199;&#x6743;&#x9650;&#x5219;&#x5141;&#x8BB8;&#x4E0A;&#x4F20;&#x3002;</span></div><div class="line">list = <span class="literal">true</span>                                                  <span class="comment"># &#x6307;&#x5B9A;&#x5F53;&#x5BA2;&#x6237;&#x8BF7;&#x6C42;&#x5217;&#x51FA;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x6A21;&#x5757;&#x5217;&#x8868;&#x65F6;&#xFF0C;&#x8BE5;&#x6A21;&#x5757;&#x662F;&#x5426;&#x5E94;&#x8BE5;&#x88AB;&#x5217;&#x51FA;&#x3002;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x8BE5;&#x9009;&#x9879;&#x4E3A; false&#xFF0C;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x9690;&#x85CF;&#x7684;&#x6A21;&#x5757;&#x3002;&#x9ED8;&#x8BA4;&#x503C;&#x662F;true&#x3002;</span></div><div class="line">use chroot = <span class="literal">false</span>                                           <span class="comment"># &#x82E5;&#x4E3A; true&#xFF0C;&#x5219; rsync &#x5728;&#x4F20;&#x8F93;&#x6587;&#x4EF6;&#x4E4B;&#x524D;&#x9996;&#x5148; chroot &#x5230; path &#x53C2;&#x6570;&#x6240;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x539F;&#x56E0;&#x662F;&#x5B9E;&#x73B0;&#x989D;&#x5916;&#x7684;&#x5B89;&#x5168;&#x9632;&#x62A4;&#xFF0C;&#x4F46;&#x662F;&#x7F3A;&#x70B9;&#x662F;&#x9700;&#x8981; root &#x6743;&#x9650;&#x3002;</span></div><div class="line">auth users = rsyncuser                                       <span class="comment"># &#x6307;&#x5B9A;&#x7531;&#x7A7A;&#x683C;&#x6216;&#x9017;&#x53F7;&#x5206;&#x9694;&#x7684;&#x7528;&#x6237;&#x540D;&#x5217;&#x8868;&#xFF0C;&#x53EA;&#x6709;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x624D;&#x5141;&#x8BB8;&#x8FDE;&#x63A5;&#x8BE5;&#x6A21;&#x5757;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD9;&#x884C;&#x5219;&#x8868;&#x660E;&#x662F;&#x533F;&#x540D;&#xFF0C;&#x6B64;&#x7528;&#x6237;&#x4E0E;&#x7CFB;&#x7EDF;&#x65E0;&#x5173;&#xFF0C;&#x662F;secrets file&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x91CC;&#x4FDD;&#x5B58;&#x7684;&#x7528;&#x6237;&#x540D;</span></div><div class="line">secrets file = /usr/<span class="built_in">local</span>/rsync/rsyncd.secrets               <span class="comment"># &#x6307;&#x5B9A;&#x4E00;&#x4E2A; rsync &#x8BA4;&#x8BC1;&#x53E3;&#x4EE4;&#x6587;&#x4EF6;&#x3002;&#x53EA;&#x6709;&#x5728; auth users &#x88AB;&#x5B9A;&#x4E49;&#x65F6;&#xFF0C;&#x8BE5;&#x6587;&#x4EF6;&#x624D;&#x8D77;&#x4F5C;&#x7528;</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;!-- toc --&gt;
&lt;!-- tocstop --&gt;
&lt;p&gt;&lt;h2&gt;inotify&lt;/h2&gt;&lt;br&gt;Linux内核从2.6.13开始，引入了inotify机制。通过intofity机制，能够对文件系统的变化进行监控，如对文件进行创建、删除、修改等操作，可以及时通知应用程序进行相关事件的处理。这种响应处理机制，避免了频繁的文件轮询任务，提高了任务的处理效率。&lt;br&gt;
    
    </summary>
    
      <category term="文件处理" scheme="http://yoursite.com/categories/%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/"/>
    
    
      <category term="rsync" scheme="http://yoursite.com/tags/rsync/"/>
    
  </entry>
  
  <entry>
    <title>mongodb分片配置</title>
    <link href="http://yoursite.com/2016/08/05/mongodb%E5%88%86%E7%89%87%E9%85%8D%E7%BD%AE/"/>
    <id>http://yoursite.com/2016/08/05/mongodb分片配置/</id>
    <published>2016-08-05T03:10:23.000Z</published>
    <updated>2016-08-05T03:35:04.955Z</updated>
    
    <content type="html"><![CDATA[<p>MongoDB &#x662F;&#x7531;C++&#x8BED;&#x8A00;&#x7F16;&#x5199;&#x7684;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;&#x5206;&#x5E03;&#x5F0F;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x7684;&#x5F00;&#x6E90;&#x6570;&#x636E;&#x5E93;&#x7CFB;&#x7EDF;&#x3002;<br>&#x5728;&#x9AD8;&#x8D1F;&#x8F7D;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6DFB;&#x52A0;&#x66F4;&#x591A;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x670D;&#x52A1;&#x5668;&#x6027;&#x80FD;&#x3002;<br>MongoDB &#x65E8;&#x5728;&#x4E3A;WEB&#x5E94;&#x7528;&#x63D0;&#x4F9B;&#x53EF;&#x6269;&#x5C55;&#x7684;&#x9AD8;&#x6027;&#x80FD;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;<br>&#x8FD9;&#x91CC;&#x5E9F;&#x8BDD;&#x4E0D;&#x591A;&#x8BF4;&#xFF0C;&#x76F4;&#x63A5;&#x5F00;&#x59CB;&#x914D;&#x7F6E;mongodb&#x5206;&#x7247;<br> <a id="more"></a></p>
<!-- toc -->
<!-- tocstop -->
<p></p><h2 id="yum&#x5B89;&#x88C5;mongodb&#x914D;&#x7F6E;&#x597D;yum&#x6E90;">yum&#x5B89;&#x88C5;mongodb(&#x914D;&#x7F6E;&#x597D;yum&#x6E90;)</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># yum -y install mongodb-server mongodb</span></div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x521B;&#x5EFA;&#x6240;&#x9700;&#x8981;&#x7684;&#x76EE;&#x5F55;">&#x521B;&#x5EFA;&#x6240;&#x9700;&#x8981;&#x7684;&#x76EE;&#x5F55;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mkdir /home/mongdb/config/{log,data} -pv</span></div><div class="line"><span class="comment"># mkdir /home/mongdb/shard{1,2,3}/{data,log} -pv</span></div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x5206;&#x522B;&#x542F;&#x52A8;config&#x670D;&#x52A1;&#x5668;">&#x5206;&#x522B;&#x542F;&#x52A8;config&#x670D;&#x52A1;&#x5668;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mongod --configsvr --dbpath=/home/mongdb/config/data/ --port 27100 --logpath=/home/mongdb/config/log/confdb.log --fork --directoryperdb</span></div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x542F;&#x52A8;&#x8DEF;&#x7531;&#x670D;&#x52A1;&#x5668;">&#x542F;&#x52A8;&#x8DEF;&#x7531;&#x670D;&#x52A1;&#x5668;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mongos --configdb 192.168.16.90:27100,192.168.16.91:27100,192.168.16.92:27100 --port 27000 --logpath=/home/mongdb/config/confdb.log --fork</span></div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x6BCF;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x5206;&#x522B;&#x542F;&#x52A8;&#x591A;&#x4E2A;&#x526F;&#x672C;&#x96C6;">&#x6BCF;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x5206;&#x522B;&#x542F;&#x52A8;&#x591A;&#x4E2A;&#x526F;&#x672C;&#x96C6;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mongod --shardsvr --replSet shard1 --port 27001 --dbpath /home/mongdb/shard1/data --logpath /home/mongdb/shard1/log/shard1.log --directoryperdb --fork</span></div><div class="line"><span class="comment"># mongod --shardsvr --replSet shard2 --port 27002 --dbpath /home/mongdb/shard2/data --logpath /home/mongdb/shard1/log/shard2.log --directoryperdb --fork</span></div><div class="line"><span class="comment"># mongod --shardsvr --replSet shard3 --port 27003 --dbpath /home/mongdb/shard3/data --logpath /home/mongdb/shard1/log/shard3.log --directoryperdb --fork</span></div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x914D;&#x7F6E;shard1&#x767B;&#x9646;90&#x6CA1;&#x6709;&#x663E;&#x5F0F;&#x6307;&#x5B9A;&#x4E3B;&#x8282;&#x70B9;&#x65F6;&#x4F1A;&#x9009;&#x62E9;&#x767B;&#x9646;&#x7684;&#x673A;&#x5668;&#x4E3A;&#x4E3B;&#x8282;&#x70B9;">&#x914D;&#x7F6E;shard1&#xFF08;&#x767B;&#x9646;90&#xFF0C;&#x6CA1;&#x6709;&#x663E;&#x5F0F;&#x6307;&#x5B9A;&#x4E3B;&#x8282;&#x70B9;&#x65F6;&#xFF0C;&#x4F1A;&#x9009;&#x62E9;&#x767B;&#x9646;&#x7684;&#x673A;&#x5668;&#x4E3A;&#x4E3B;&#x8282;&#x70B9;&#xFF09;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mongo --port 27001</div><div class="line">&gt; use admin</div><div class="line">switched to db admin</div><div class="line">&gt; rs.initiate({</div><div class="line">... _id: <span class="string">&apos;shard1&apos;</span>,</div><div class="line">... members: [</div><div class="line">... {_id: 90,host: <span class="string">&apos;192.168.16.90:27001&apos;</span>},</div><div class="line">... {_id: 91,host: <span class="string">&apos;192.169.16.91:27001&apos;</span>},</div><div class="line">... {_id: 92,host: <span class="string">&apos;192.168.16.92:27001&apos;</span>,arbiterOnly: <span class="literal">true</span>}</div><div class="line">... ]</div><div class="line">... });</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x914D;&#x7F6E;shard2&#x767B;&#x5F55;91">&#x914D;&#x7F6E;shard2(&#x767B;&#x5F55;91)</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mongo --port 27002</div><div class="line">shard1:SECONDARY&gt; use admin</div><div class="line">switched to db admin</div><div class="line">shard1:SECONDARY&gt; rs.initiate({</div><div class="line">... _id: <span class="string">&apos;shard2&apos;</span>,</div><div class="line">...  members: [</div><div class="line">... {_id: 90,host: <span class="string">&apos;192.168.16.90:27001&apos;</span>,arbiterOnly: <span class="literal">true</span>},</div><div class="line">... {_id: 91,host: <span class="string">&apos;192.169.16.91:27001&apos;</span>},</div><div class="line">... {_id: 92,host: <span class="string">&apos;192.168.16.92:27001&apos;</span>}</div><div class="line">... ]</div><div class="line">... });</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x914D;&#x7F6E;shard3&#x767B;&#x5F55;92">&#x914D;&#x7F6E;shard3(&#x767B;&#x5F55;92)</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mongo --port 27003</div><div class="line">shard1:SECONDARY&gt; use admin</div><div class="line">rs.initiate({ _id: <span class="string">&apos;shard3&apos;</span>,  members: [ {_id: 90,host: <span class="string">&apos;192.168.16.90:27003&apos;</span>}, {_id: 91,host: <span class="string">&apos;192.169.16.91:27003&apos;</span>,arbiterOnly: <span class="literal">true</span>}, {_id: 92,host: <span class="string">&apos;192.168.16.92:27003&apos;</span>} ] });</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x8BBE;&#x7F6E;&#x8DEF;&#x7531;&#x5230;&#x5206;&#x7247;&#x96C6;&#x7FA4;&#x914D;&#x7F6E;">&#x8BBE;&#x7F6E;&#x8DEF;&#x7531;&#x5230;&#x5206;&#x7247;&#x96C6;&#x7FA4;&#x914D;&#x7F6E;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">db.runCommand({addShard: <span class="string">&apos;shard2/192.168.16.90:27002,192.168.16.91:27002,192.168.16.92:27002&apos;</span>});</div><div class="line">{ <span class="string">&quot;shardAdded&quot;</span> : <span class="string">&quot;shard2&quot;</span>, <span class="string">&quot;ok&quot;</span> : 1 }</div><div class="line">mongos&gt; db.runCommand({addShard: <span class="string">&apos;shard3/192.168.16.90:27003,192.168.16.91:27003,192.168.16.92:27003&apos;</span>});</div><div class="line">{ <span class="string">&quot;shardAdded&quot;</span> : <span class="string">&quot;shard3&quot;</span>, <span class="string">&quot;ok&quot;</span> : 1 }</div><div class="line">mongos&gt; db.runCommand({addShard: <span class="string">&apos;shard1/192.168.16.90:27001,192.168.16.91:27001,192.168.16.92:27001&apos;</span>});</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x67E5;&#x770B;&#x914D;&#x7F6E;&#x597D;&#x7684;shard">&#x67E5;&#x770B;&#x914D;&#x7F6E;&#x597D;&#x7684;shard</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">mongos&gt; db.runCommand({listshards: 1});</div><div class="line">{</div><div class="line">	<span class="string">&quot;shards&quot;</span> : [</div><div class="line">		{</div><div class="line">			<span class="string">&quot;_id&quot;</span> : <span class="string">&quot;shard1&quot;</span>,</div><div class="line">			<span class="string">&quot;host&quot;</span> : <span class="string">&quot;shard1/192.168.16.90:27001,192.168.16.91:27001&quot;</span></div><div class="line">		},</div><div class="line">		{</div><div class="line">			<span class="string">&quot;_id&quot;</span> : <span class="string">&quot;shard2&quot;</span>,</div><div class="line">			<span class="string">&quot;host&quot;</span> : <span class="string">&quot;shard2/192.168.16.91:27002,192.168.16.92:27002&quot;</span></div><div class="line">		},</div><div class="line">		{</div><div class="line">			<span class="string">&quot;_id&quot;</span> : <span class="string">&quot;shard3&quot;</span>,</div><div class="line">			<span class="string">&quot;host&quot;</span> : <span class="string">&quot;shard3/192.168.16.90:27003,192.168.16.92:27003&quot;</span></div><div class="line">		}</div><div class="line">	],</div><div class="line">	<span class="string">&quot;ok&quot;</span> : 1</div><div class="line">}</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x6D4B;&#x8BD5;&#x5206;&#x7247;">&#x6D4B;&#x8BD5;&#x5206;&#x7247;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">mongos&gt; use admin</div><div class="line">mongos&gt; db.runCommand({enablesharding: <span class="string">&apos;dbtest&apos;</span>});</div><div class="line">mongos&gt; db.runCommand({shardcollection: <span class="string">&apos;dbtest.coll1&apos;</span>, key: {id: 1}});</div><div class="line">mongos&gt; use dbtest;</div><div class="line">mongos&gt; <span class="keyword">for</span>(var i=0; i&lt;10000; i++) db.coll1.insert({id: i, s: <span class="string">&apos;str_&apos;</span> + i});</div><div class="line">mongos&gt; db.coll1.stats()</div><div class="line">	<span class="string">&quot;shard1&quot;</span> : {</div><div class="line">	<span class="string">&quot;ns&quot;</span> : <span class="string">&quot;dbtest.coll1&quot;</span>,</div><div class="line">	<span class="string">&quot;count&quot;</span> : 1,</div><div class="line">	<span class="string">&quot;size&quot;</span> : 47,</div><div class="line">	<span class="string">&quot;avgObjSize&quot;</span> : 47,</div><div class="line">	<span class="string">&quot;storageSize&quot;</span> : 4096,</div><div class="line">	<span class="string">&quot;capped&quot;</span> : <span class="literal">false</span>,</div><div class="line">	<span class="string">&quot;wiredTiger&quot;</span> : {</div><div class="line"></div><div class="line">	<span class="string">&quot;shard2&quot;</span> : {</div><div class="line">	<span class="string">&quot;ns&quot;</span> : <span class="string">&quot;dbtest.coll1&quot;</span>,</div><div class="line">	<span class="string">&quot;count&quot;</span> : 9979,</div><div class="line">	<span class="string">&quot;size&quot;</span> : 497892,</div><div class="line">	<span class="string">&quot;avgObjSize&quot;</span> : 49,</div><div class="line">	<span class="string">&quot;storageSize&quot;</span> : 4096,</div><div class="line">	<span class="string">&quot;capped&quot;</span> : <span class="literal">false</span>,</div><div class="line">	<span class="string">&quot;wiredTiger&quot;</span> : {</div><div class="line">	</div><div class="line">	<span class="string">&quot;shard3&quot;</span> : {</div><div class="line">	<span class="string">&quot;ns&quot;</span> : <span class="string">&quot;dbtest.coll1&quot;</span>,</div><div class="line">	<span class="string">&quot;count&quot;</span> : 20,</div><div class="line">	<span class="string">&quot;size&quot;</span> : 951,</div><div class="line">	<span class="string">&quot;avgObjSize&quot;</span> : 47,</div><div class="line">	<span class="string">&quot;storageSize&quot;</span> : 16384,</div><div class="line">	<span class="string">&quot;capped&quot;</span> : <span class="literal">false</span>,</div><div class="line">	<span class="string">&quot;wiredTiger&quot;</span> : {</div></pre></td></tr></table></figure><p></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x8FD9;&#x91CC;&#x5206;&#x7247;&#x5DF2;&#x7ECF;&#x751F;&#x6548;&#xFF0C;&#x53EA;&#x662F;&#x5206;&#x914D;&#x4E0D;&#x5747;&#x5300;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5B58;&#x5728;&#x4E86;shard2&#x4E2D;&#x4E86;</p>
<p></p><h2 id="&#x4F7F;&#x7528;hashed-shard-key&#x7B97;&#x6CD5;&#x4FDD;&#x8BC1;&#x6587;&#x6863;&#x5747;&#x5300;&#x5206;&#x5E03;">&#x4F7F;&#x7528;hashed shard key&#x7B97;&#x6CD5;&#x4FDD;&#x8BC1;&#x6587;&#x6863;&#x5747;&#x5300;&#x5206;&#x5E03;</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mongo --port 27000</div><div class="line">use admin</div><div class="line">sh.shardCollection(<span class="string">&apos;dbtest.coll1&apos;</span>, {id: <span class="string">&apos;hashed&apos;</span>});</div></pre></td></tr></table></figure><p></p>
<p></p><h2 id="&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FDE;&#x63A5;&#x8DEF;&#x7531;&#x8282;&#x70B9;&#x6765;&#x5B9E;&#x73B0;&#x6570;&#x636E;&#x7684;&#x5206;&#x7247;">&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FDE;&#x63A5;&#x8DEF;&#x7531;&#x8282;&#x70B9;&#x6765;&#x5B9E;&#x73B0;&#x6570;&#x636E;&#x7684;&#x5206;&#x7247;</h2><br>    &#x8FD9;&#x91CC;&#x8FDE;&#x63A5;&#x4EFB;&#x4F55;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x7684;27000&#x7AEF;&#x53E3;&#x90FD;&#x884C;&#x3002;<p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MongoDB 是由C++语言编写的，是一个基于分布式文件存储的开源数据库系统。&lt;br&gt;在高负载的情况下，添加更多的节点，可以保证服务器性能。&lt;br&gt;MongoDB 旨在为WEB应用提供可扩展的高性能数据存储解决方案。&lt;br&gt;这里废话不多说，直接开始配置mongodb分片&lt;br&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="mongodb" scheme="http://yoursite.com/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>一次处理故障的记录</title>
    <link href="http://yoursite.com/2016/08/04/%E4%B8%80%E6%AC%A1%E5%A4%84%E7%90%86%E6%95%85%E9%9A%9C%E7%9A%84%E8%AE%B0%E5%BD%95/"/>
    <id>http://yoursite.com/2016/08/04/一次处理故障的记录/</id>
    <published>2016-08-04T09:25:39.000Z</published>
    <updated>2016-08-05T01:20:17.223Z</updated>
    
    <content type="html"><![CDATA[<!-- toc -->
<!-- tocstop -->
<p>&#x670D;&#x52A1;&#x5668;&#x4E0D;&#x505C;&#x7684;&#x5411;&#x5916;&#x53D1;&#x5305;&#xFF0C;&#x4E14;CPU&#x6301;&#x7EED;100%&#xFF0C;&#x8FDC;&#x7A0B;&#x767B;&#x5F55;&#x540E;&#x67E5;&#x770B;&#x53D1;&#x73B0;&#x6709;&#x4E00;&#x957F;&#x5EA6;&#x4E3A;10&#x7684;&#x968F;&#x673A;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x7A0B;&#xFF0C;<br>kill&#x6389;&#xFF0C;&#x4F1A;&#x91CD;&#x65B0;&#x751F;&#x6210;&#x53E6;&#x5916;&#x957F;&#x5EA6;&#x4E3A;10&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x7A0B;&#x3002;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x4E5F;&#x4F1A;&#x91CD;&#x590D;&#x751F;&#x6210;&#xFF0C;&#x975E;&#x5E38;&#x75DB;&#x82E6;&#x3002;&#x67E5;&#x9605;crond&#x76F8;&#x5173;&#x65E5;&#x5FD7;&#xFF0C;<br>&#x53D1;&#x73B0;&#x5B9E;&#x9645;&#x6267;&#x884C;&#x7684;&#x5185;&#x5BB9;&#x4E3A;/lib/libudev.so &#xFF0C;&#x4EE5;&#x6B64;&#x4E3A;&#x5173;&#x952E;&#x5B57;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#xFF0C;&#x627E;&#x5230;&#x5982;&#x4E0B;&#x5185;&#x5BB9;&#xFF1A;<br>&#x7DB2;&#x8DEF;&#x6D41;&#x91CF;&#x66B4;&#x589E;&#xFF0C;&#x4F7F;&#x7528; top &#x89C0;&#x5BDF;&#x6709;&#x81F3;&#x5C11;&#x4E00;&#x500B; 10 &#x500B;&#x96A8;&#x6A5F;&#x5B57;&#x6BCD;&#x7D44;&#x6210;&#x7684;&#x7A0B;&#x5E8F;&#x57F7;&#x884C;&#xFF0C;&#x4F54;&#x7528;&#x5927;&#x91CF; CPU &#x4F7F;&#x7528;&#x7387;&#x3002;&#x522A;&#x9664;&#x9019;&#x4E9B;&#x7A0B;&#x5E8F;&#xFF0C;&#x99AC;&#x4E0A;&#x53C8;&#x7522;&#x751F;&#x65B0;&#x7684;&#x7A0B;&#x5E8F;&#x3002;<br> <a id="more"></a></p>
<p>&#x6AA2;&#x67E5; cat /etc/crontab &#x53D1;&#x73B0;&#x5B9A;&#x65F6;&#x4EFB;&#x52A1; &#x6BCF;&#x4E09;&#x5206;&#x9418;&#x57F7;&#x884C;gcc.sh</p>
<pre><code># */3 * * * * root /etc/cron.hourly/gcc.sh
</code></pre><p>&#x67E5;&#x770B;&#x75C5;&#x6BD2;&#x7A0B;&#x5F0F; gcc.sh&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x75C5;&#x6BD2;&#x672C;&#x9AD4;&#x662F; /lib/libudev.so&#x3002;<br>    [root@deyu ~]# cat /etc/cron.hourly/gcc.sh</p>
<pre><code>#!/bin/sh
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/X11R6/bin
for i in `cat /proc/net/dev|grep :|awk -F: {&apos;print $1&apos;}`; do ifconfig $i up&amp; done
cp /lib/libudev.so /lib/libudev.so.6
/lib/libudev.so.6
</code></pre><p>&#x522A;&#x9664;&#x4E0A;&#x4E00;&#x884C;&#x4F8B;&#x884C;&#x5DE5;&#x4F5C; gcc.sh&#xFF0C;&#x4E26;&#x8A2D;&#x5B9A; /etc/crontab &#x7121;&#x6CD5;&#x8B8A;&#x52D5;&#xFF0C;&#x5426;&#x5247;&#x99AC;&#x4E0A;&#x53C8;&#x6703;&#x7522;&#x751F;&#x3002;</p>
<pre><code># rm -f /etc/cron.hourly/gcc.sh ; chattr +i /etc/crontab
</code></pre><p>&#x4F7F;&#x7528; top &#x67E5;&#x770B;&#x75C5;&#x6BD2;&#x70BA; mtyxkeaofa&#xFF0C;id &#x70BA; 16621&#xFF0C;&#x4E0D;&#x8981;&#x76F4;&#x63A5;&#x6BBA;&#x6389;&#x7A0B;&#x5E8F;&#xFF0C;&#x5426;&#x5247;&#x6703;&#x518D;&#x7522;&#x751F;&#xFF0C;&#x800C;&#x662F;&#x505C;&#x6B62;&#x5176;&#x904B;&#x4F5C;&#x3002;</p>
<pre><code># kill -STOP 16621
</code></pre><p>&#x522A;&#x9664; /etc/init.d &#x5167;&#x7684;&#x6A94;&#x6848;&#x3002;</p>
<pre><code># find /etc -name &apos;*mtyxkeaofa*&apos; | xargs rm -f
</code></pre><p>&#x522A;&#x9664; /usr/bin &#x5167;&#x7684;&#x6A94;&#x6848;&#x3002;</p>
<pre><code># rm -f /usr/bin/mtyxkeaofa
</code></pre><p>&#x67E5;&#x770B; /usr/bin &#x6700;&#x8FD1;&#x8B8A;&#x52D5;&#x7684;&#x6A94;&#x6848;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x75C5;&#x6BD2;&#x4E5F;&#x4E00;&#x4F75;&#x522A;&#x9664;&#xFF0C;&#x5176;&#x4ED6;&#x53EF;&#x7591;&#x7684;&#x76EE;&#x9304;&#x4E5F;&#x4E00;&#x6A23;&#x3002;</p>
<pre><code># ls -lt /usr/bin | head
</code></pre><p>&#x73FE;&#x5728;&#x6BBA;&#x6389;&#x75C5;&#x6BD2;&#x7A0B;&#x5E8F;&#xFF0C;&#x5C31;&#x4E0D;&#x6703;&#x518D;&#x7522;&#x751F;&#x3002;</p>
<pre><code># pkill mtyxkeaofa
</code></pre><p>&#x522A;&#x9664;&#x75C5;&#x6BD2;&#x672C;&#x9AD4;&#x3002;</p>
<pre><code># rm -f /lib/libudev.so
</code></pre><p>&#x4F7F;&#x7528;&#x6B64;&#x65B9;&#x6CD5; &#x53EF;&#x4EE5;&#x5B8C;&#x5168;&#x6E05;&#x9664;&#x6B64;&#x75C5;&#x6BD2;&#x3002;</p>
]]></content>
    
    <summary type="html">
    
      &lt;!-- toc --&gt;
&lt;!-- tocstop --&gt;
&lt;p&gt;服务器不停的向外发包，且CPU持续100%，远程登录后查看发现有一长度为10的随机字符串进程，&lt;br&gt;kill掉，会重新生成另外长度为10的字符串进程。删除文件也会重复生成，非常痛苦。查阅crond相关日志，&lt;br&gt;发现实际执行的内容为/lib/libudev.so ，以此为关键字进行查询，找到如下内容：&lt;br&gt;網路流量暴增，使用 top 觀察有至少一個 10 個隨機字母組成的程序執行，佔用大量 CPU 使用率。刪除這些程序，馬上又產生新的程序。&lt;br&gt;
    
    </summary>
    
      <category term="故障处理" scheme="http://yoursite.com/categories/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
    
      <category term="故障" scheme="http://yoursite.com/tags/%E6%95%85%E9%9A%9C/"/>
    
  </entry>
  
  <entry>
    <title>关于http健康状态检测遗留下的大量日志问题</title>
    <link href="http://yoursite.com/2016/05/30/%E5%85%B3%E4%BA%8Ehttp%E5%81%A5%E5%BA%B7%E7%8A%B6%E6%80%81%E6%A3%80%E6%B5%8B%E9%81%97%E7%95%99%E4%B8%8B%E7%9A%84%E5%A4%A7%E9%87%8F%E6%97%A5%E5%BF%97%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2016/05/30/关于http健康状态检测遗留下的大量日志问题/</id>
    <published>2016-05-30T09:00:05.000Z</published>
    <updated>2016-08-05T07:06:36.093Z</updated>
    
    <content type="html"><![CDATA[<p>&#x76F8;&#x4FE1;&#x5C0F;&#x4F19;&#x4F34;&#x4EEC;&#x5728;&#x505A;keepalived&#x3001;haproxy&#x6216;&#x8005;pacemaker&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7ED9;httpd&#x505A;&#x5065;&#x5EB7;&#x72B6;&#x6001;&#x68C0;&#x6D4B;&#x4E00;&#x5B9A;&#x4F1A;&#x7ED9;&#x540E;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#x5E26;&#x6765;&#x5927;&#x91CF;&#x7684;&#x8BBF;&#x95EE;&#x65E5;&#x5FD7;&#x3002;&#x8BBF;&#x95EE;&#x65E5;&#x5FD7;&#x5BF9;&#x6211;&#x4EEC;&#x8FD0;&#x7EF4;&#x6765;&#x8BF4;&#x81F3;&#x5173;&#x91CD;&#x8981;&#xFF08;&#x540E;&#x671F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x65E5;&#x5FD7;&#x6765;&#x5206;&#x6790;&#x7528;&#x6237;&#x7684;&#x5404;&#x79CD;&#x884C;&#x4E3A;&#xFF09;&#xFF0C;&#x4F46;&#x662F;&#x5065;&#x5EB7;&#x72B6;&#x6001;&#x68C0;&#x6D4B;&#x7684;&#x65E5;&#x5FD7;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x3002;&#x6BD5;&#x7ADF;&#x6BCF;&#x4E24;&#x4E09;&#x79D2;&#x8BB0;&#x5F55;&#x4E00;&#x6B21;&#xFF0C;&#x800C;&#x4E14;&#x540E;&#x671F;&#x7EDF;&#x8BA1;&#x65F6;&#x5BF9;&#x6211;&#x4EEC;&#x4E5F;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x7528;&#x3002;</p>
<a id="more"></a>
<p>&#x672C;&#x6587;&#x5C06;&#x5177;&#x4F53;&#x8BF4;&#x660E;&#x5982;&#x4F55;&#x5728;&#x540E;&#x7AEF;&#x4E3B;&#x673A;nginx &#x3001; apache &#x670D;&#x52A1;&#x5668;&#x4E0A;&#x914D;&#x7F6E;&#x4E0D;&#x8BB0;&#x5F55;&#x5065;&#x5EB7;&#x72B6;&#x6001;&#x68C0;&#x6D4B;&#x7684;&#x8BBF;&#x95EE;&#x65E5;&#x5FD7;&#x3002;</p>
<p>nginx</p>
<p>&#x4E00;&#x822C;&#x57FA;&#x4E8E;7&#x5C42;&#x7684;&#x5065;&#x5EB7;&#x72B6;&#x6001;&#x68C0;&#x6D4B;&#xFF0C;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x8BBF;&#x95EE;&#x540E;&#x7AEF;&#x4E3B;&#x673A;&#x7684;&#x7279;&#x5B9A;&#x7684;url&#xFF0C; &#x7279;&#x6027;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x8D44;&#x6E90;&#xFF0C;&#x6765;&#x5224;&#x65AD;&#x540E;&#x7AEF;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x51FA;&#x73B0;&#x6545;&#x969C;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5728;nginx&#x7684;server&#x6BB5;&#x4E0A;&#x52A0;&#x4E00;&#x4E2A;location&#x3002;&#x8BBF;&#x95EE;&#x6211;&#x4EEC;&#x7279;&#x6709;&#x7684;&#x5065;&#x5EB7;&#x72B6;&#x6001;&#x68C0;&#x6D4B;&#x7684;&#x8D44;&#x6E90;&#xFF0C;&#x4E0D;&#x4E88;&#x4EE5;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x5373;&#x53EF;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x7167;&#x5E38;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x3002;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">location = /test.html {</div><div class="line">access_<span class="built_in">log</span> off;</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>apache</p>
<p>1.&#x6307;&#x5B9A;&#x8BB0;&#x5F55;&#x6CD5;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SetEnvIfNoCase Request_URI <span class="string">&quot;(\.htm|\/|\.html|\.php)$&quot;</span> htm  </div><div class="line">CustomLog logs/9enjoy.com-access_<span class="built_in">log</span> combined env=htm</div></pre></td></tr></table></figure></p>
<p>2.&#x6392;&#x9664;&#x6CD5;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;FilesMatch <span class="string">&quot;\.html&quot;</span>&gt;</div><div class="line">SetEnv IMAGE 1</div><div class="line">&lt;/FilesMatch&gt;</div><div class="line">CustomLog <span class="string">&quot;logs/access_log&quot;</span> combined env=!IMAGE</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;相信小伙伴们在做keepalived、haproxy或者pacemaker的时候，给httpd做健康状态检测一定会给后端服务器带来大量的访问日志。访问日志对我们运维来说至关重要（后期我们可以通过日志来分析用户的各种行为），但是健康状态检测的日志我们可以不用记录日志。毕竟每两三秒记录一次，而且后期统计时对我们也没有什么用。&lt;/p&gt;
    
    </summary>
    
      <category term="运维" scheme="http://yoursite.com/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="nginx" scheme="http://yoursite.com/tags/nginx/"/>
    
  </entry>
  
</feed>
